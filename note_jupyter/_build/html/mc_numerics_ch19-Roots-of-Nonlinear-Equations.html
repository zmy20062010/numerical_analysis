
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>第19章: 非线性方程求根 &#8212; My sample book</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Markdown Files" href="markdown.html" />
    <link rel="prev" title="第14章: 线性方程组求解" href="mc_numerics_ch14-Linear-System-of-Equations.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">My sample book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome to your Jupyter Book
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="mc_numerics_ch00_index.html">
   <center>
    数值计算方法 - Python实现
   </center>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mc_numerics_ch01-Python-Basics.html">
   <center>
    第01章: Python基础
   </center>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mc_numerics_ch14-Linear-System-of-Equations.html">
   <center>
    第14章: 线性方程组求解
   </center>
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   <center>
    第19章: 非线性方程求根
   </center>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markdown.html">
   Markdown Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks.html">
   Content with notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markdown-notebooks.html">
   Notebooks with MyST Markdown
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/mc_numerics_ch19-Roots-of-Nonlinear-Equations.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fmc_numerics_ch19-Roots-of-Nonlinear-Equations.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/mc_numerics_ch19-Roots-of-Nonlinear-Equations.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   <center>
    第19章: 非线性方程求根
   </center>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     引言
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tolerance">
     容差（Tolerance）
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       准确度和精密度
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#accuracy-and-precision-png">
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     误差、精度和容差
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bisection-method">
     二分法（Bisection Method）
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       二分法的基本原理
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       二分法的示例
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#python">
       二分法的Python实现
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id6">
         二分法的Python函数
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id7">
         二分法的Python实现示例
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       思考题
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fixed-point-iteration-method">
     不动点迭代法 （Fixed-Point Iteration Method）
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       不动点迭代法的基本原理
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id10">
       不动点迭代法的示例
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id11">
       不动点迭代法的收敛性
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id12">
         全局收敛性判断定理
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id13">
         收敛性判断示例
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id14">
         局部收敛性判断
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id15">
       不动点迭代法的Python实现
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#newton-method-or-newton-raphson-method">
     牛顿法（Newton Method or Newton-Raphson Method）
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#newton">
       Newton法的基本原理
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id16">
       Newton法的收敛性
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id17">
       Newton法的示例
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id18">
       Newton法的变种
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id19">
         简化的Newton法
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id20">
         Newton下山法
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#newtonpython">
       Newton法的Python实现
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id21">
         Python代码
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id22">
         Python代码使用实例
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id23">
         Python代码使用训练题
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convergence-and-acceleration">
     迭代法的收敛速度及其加速 （Convergence and Acceleration)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id24">
       迭代法的收敛加速
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id25">
       Python示例
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-complex-methods">
     其他复杂方法 （Other Complex Methods）
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#secant-method">
       割线法（Secant Method）
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id26">
         割线法作为二分法的变种
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id27">
         割线法作为Newton法的变种
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id28">
         其他实现
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#inverse-quadratic-interpolation-method">
       反向二次插值法(Inverse Quadratic Interpolation Method)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#brent-brent-s-method">
       Brent法（Brent’s Method）
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#preparing-initial-values-and-conditions">
         Preparing initial values and conditions
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#the-iterative-process">
         The iterative process
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#finding-b-k-1">
         Finding b_{k+1}
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#rate-of-convergence">
         Rate of convergence
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id29">
     利用Python对函数进行求根
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id30">
     小结
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id31">
     习题和讨论
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1><center> 第19章: 非线性方程求根</center></h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   <center>
    第19章: 非线性方程求根
   </center>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     引言
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tolerance">
     容差（Tolerance）
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       准确度和精密度
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#accuracy-and-precision-png">
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     误差、精度和容差
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bisection-method">
     二分法（Bisection Method）
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       二分法的基本原理
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       二分法的示例
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#python">
       二分法的Python实现
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id6">
         二分法的Python函数
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id7">
         二分法的Python实现示例
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       思考题
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fixed-point-iteration-method">
     不动点迭代法 （Fixed-Point Iteration Method）
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       不动点迭代法的基本原理
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id10">
       不动点迭代法的示例
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id11">
       不动点迭代法的收敛性
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id12">
         全局收敛性判断定理
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id13">
         收敛性判断示例
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id14">
         局部收敛性判断
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id15">
       不动点迭代法的Python实现
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#newton-method-or-newton-raphson-method">
     牛顿法（Newton Method or Newton-Raphson Method）
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#newton">
       Newton法的基本原理
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id16">
       Newton法的收敛性
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id17">
       Newton法的示例
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id18">
       Newton法的变种
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id19">
         简化的Newton法
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id20">
         Newton下山法
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#newtonpython">
       Newton法的Python实现
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id21">
         Python代码
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id22">
         Python代码使用实例
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id23">
         Python代码使用训练题
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convergence-and-acceleration">
     迭代法的收敛速度及其加速 （Convergence and Acceleration)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id24">
       迭代法的收敛加速
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id25">
       Python示例
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-complex-methods">
     其他复杂方法 （Other Complex Methods）
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#secant-method">
       割线法（Secant Method）
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id26">
         割线法作为二分法的变种
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id27">
         割线法作为Newton法的变种
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id28">
         其他实现
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#inverse-quadratic-interpolation-method">
       反向二次插值法(Inverse Quadratic Interpolation Method)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#brent-brent-s-method">
       Brent法（Brent’s Method）
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#preparing-initial-values-and-conditions">
         Preparing initial values and conditions
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#the-iterative-process">
         The iterative process
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#finding-b-k-1">
         Finding b_{k+1}
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#rate-of-convergence">
         Rate of convergence
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id29">
     利用Python对函数进行求根
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id30">
     小结
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id31">
     习题和讨论
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="center-19-center">
<h1><center> 第19章: 非线性方程求根</center><a class="headerlink" href="#center-19-center" title="Permalink to this headline">¶</a></h1>
<center>（Chapter 19: Roots of Nonlinear Equations）</center><h1>Table of Contents<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#引言" data-toc-modified-id="引言-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>引言</a></span></li><li><span><a href="#容差（Tolerance）" data-toc-modified-id="容差（Tolerance）-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>容差（Tolerance）</a></span><ul class="toc-item"><li><span><a href="#准确度和精密度" data-toc-modified-id="准确度和精密度-2.1"><span class="toc-item-num">2.1&nbsp;&nbsp;</span>准确度和精密度</a></span></li><li><span><a href="#误差、精度和容差" data-toc-modified-id="误差、精度和容差-2.2"><span class="toc-item-num">2.2&nbsp;&nbsp;</span>误差、精度和容差</a></span></li></ul></li><li><span><a href="#二分法（Bisection-Method）" data-toc-modified-id="二分法（Bisection-Method）-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>二分法（Bisection Method）</a></span><ul class="toc-item"><li><span><a href="#二分法的基本原理" data-toc-modified-id="二分法的基本原理-3.1"><span class="toc-item-num">3.1&nbsp;&nbsp;</span>二分法的基本原理</a></span></li><li><span><a href="#二分法的示例" data-toc-modified-id="二分法的示例-3.2"><span class="toc-item-num">3.2&nbsp;&nbsp;</span>二分法的示例</a></span></li><li><span><a href="#二分法的Python实现" data-toc-modified-id="二分法的Python实现-3.3"><span class="toc-item-num">3.3&nbsp;&nbsp;</span>二分法的Python实现</a></span><ul class="toc-item"><li><span><a href="#二分法的Python函数" data-toc-modified-id="二分法的Python函数-3.3.1"><span class="toc-item-num">3.3.1&nbsp;&nbsp;</span>二分法的Python函数</a></span></li><li><span><a href="#二分法的Python实现示例" data-toc-modified-id="二分法的Python实现示例-3.3.2"><span class="toc-item-num">3.3.2&nbsp;&nbsp;</span>二分法的Python实现示例</a></span></li></ul></li><li><span><a href="#思考题" data-toc-modified-id="思考题-3.4"><span class="toc-item-num">3.4&nbsp;&nbsp;</span>思考题</a></span></li></ul></li><li><span><a href="#不动点迭代法-（Fixed-Point-Iteration-Method）" data-toc-modified-id="不动点迭代法-（Fixed-Point-Iteration-Method）-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>不动点迭代法 （Fixed-Point Iteration Method）</a></span><ul class="toc-item"><li><span><a href="#不动点迭代法的基本原理" data-toc-modified-id="不动点迭代法的基本原理-4.1"><span class="toc-item-num">4.1&nbsp;&nbsp;</span>不动点迭代法的基本原理</a></span></li><li><span><a href="#不动点迭代法的示例" data-toc-modified-id="不动点迭代法的示例-4.2"><span class="toc-item-num">4.2&nbsp;&nbsp;</span>不动点迭代法的示例</a></span></li><li><span><a href="#不动点迭代法的收敛性" data-toc-modified-id="不动点迭代法的收敛性-4.3"><span class="toc-item-num">4.3&nbsp;&nbsp;</span>不动点迭代法的收敛性</a></span><ul class="toc-item"><li><span><a href="#全局收敛性判断定理" data-toc-modified-id="全局收敛性判断定理-4.3.1"><span class="toc-item-num">4.3.1&nbsp;&nbsp;</span>全局收敛性判断定理</a></span></li><li><span><a href="#收敛性判断示例" data-toc-modified-id="收敛性判断示例-4.3.2"><span class="toc-item-num">4.3.2&nbsp;&nbsp;</span>收敛性判断示例</a></span></li><li><span><a href="#局部收敛性判断" data-toc-modified-id="局部收敛性判断-4.3.3"><span class="toc-item-num">4.3.3&nbsp;&nbsp;</span>局部收敛性判断</a></span></li></ul></li><li><span><a href="#不动点迭代法的Python实现" data-toc-modified-id="不动点迭代法的Python实现-4.4"><span class="toc-item-num">4.4&nbsp;&nbsp;</span>不动点迭代法的Python实现</a></span></li></ul></li><li><span><a href="#牛顿法（Newton-Method-or-Newton-Raphson-Method）" data-toc-modified-id="牛顿法（Newton-Method-or-Newton-Raphson-Method）-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>牛顿法（Newton Method or Newton-Raphson Method）</a></span><ul class="toc-item"><li><span><a href="#Newton法的基本原理" data-toc-modified-id="Newton法的基本原理-5.1"><span class="toc-item-num">5.1&nbsp;&nbsp;</span>Newton法的基本原理</a></span></li><li><span><a href="#Newton法的收敛性" data-toc-modified-id="Newton法的收敛性-5.2"><span class="toc-item-num">5.2&nbsp;&nbsp;</span>Newton法的收敛性</a></span></li><li><span><a href="#Newton法的示例" data-toc-modified-id="Newton法的示例-5.3"><span class="toc-item-num">5.3&nbsp;&nbsp;</span>Newton法的示例</a></span></li><li><span><a href="#Newton法的变种" data-toc-modified-id="Newton法的变种-5.4"><span class="toc-item-num">5.4&nbsp;&nbsp;</span>Newton法的变种</a></span><ul class="toc-item"><li><span><a href="#简化的Newton法" data-toc-modified-id="简化的Newton法-5.4.1"><span class="toc-item-num">5.4.1&nbsp;&nbsp;</span>简化的Newton法</a></span></li><li><span><a href="#Newton下山法" data-toc-modified-id="Newton下山法-5.4.2"><span class="toc-item-num">5.4.2&nbsp;&nbsp;</span>Newton下山法</a></span></li></ul></li><li><span><a href="#Newton法的Python实现" data-toc-modified-id="Newton法的Python实现-5.5"><span class="toc-item-num">5.5&nbsp;&nbsp;</span>Newton法的Python实现</a></span><ul class="toc-item"><li><span><a href="#Python代码" data-toc-modified-id="Python代码-5.5.1"><span class="toc-item-num">5.5.1&nbsp;&nbsp;</span>Python代码</a></span></li><li><span><a href="#Python代码使用实例" data-toc-modified-id="Python代码使用实例-5.5.2"><span class="toc-item-num">5.5.2&nbsp;&nbsp;</span>Python代码使用实例</a></span></li><li><span><a href="#Python代码使用训练题" data-toc-modified-id="Python代码使用训练题-5.5.3"><span class="toc-item-num">5.5.3&nbsp;&nbsp;</span>Python代码使用训练题</a></span></li></ul></li></ul></li><li><span><a href="#迭代法的收敛速度及其加速-（Convergence-and-Acceleration)" data-toc-modified-id="迭代法的收敛速度及其加速-（Convergence-and-Acceleration)-6"><span class="toc-item-num">6&nbsp;&nbsp;</span>迭代法的收敛速度及其加速 （Convergence and Acceleration)</a></span><ul class="toc-item"><li><span><a href="#迭代法的收敛加速" data-toc-modified-id="迭代法的收敛加速-6.1"><span class="toc-item-num">6.1&nbsp;&nbsp;</span>迭代法的收敛加速</a></span></li><li><span><a href="#Python示例" data-toc-modified-id="Python示例-6.2"><span class="toc-item-num">6.2&nbsp;&nbsp;</span>Python示例</a></span></li></ul></li><li><span><a href="#其他复杂方法-（Other-Complex-Methods）" data-toc-modified-id="其他复杂方法-（Other-Complex-Methods）-7"><span class="toc-item-num">7&nbsp;&nbsp;</span>其他复杂方法 （Other Complex Methods）</a></span><ul class="toc-item"><li><span><a href="#割线法（Secant-Method）" data-toc-modified-id="割线法（Secant-Method）-7.1"><span class="toc-item-num">7.1&nbsp;&nbsp;</span>割线法（Secant Method）</a></span><ul class="toc-item"><li><span><a href="#割线法作为二分法的变种" data-toc-modified-id="割线法作为二分法的变种-7.1.1"><span class="toc-item-num">7.1.1&nbsp;&nbsp;</span>割线法作为二分法的变种</a></span></li><li><span><a href="#割线法作为Newton法的变种" data-toc-modified-id="割线法作为Newton法的变种-7.1.2"><span class="toc-item-num">7.1.2&nbsp;&nbsp;</span>割线法作为Newton法的变种</a></span></li><li><span><a href="#其他实现" data-toc-modified-id="其他实现-7.1.3"><span class="toc-item-num">7.1.3&nbsp;&nbsp;</span>其他实现</a></span></li></ul></li><li><span><a href="#反向二次插值法(Inverse-Quadratic-Interpolation-Method)" data-toc-modified-id="反向二次插值法(Inverse-Quadratic-Interpolation-Method)-7.2"><span class="toc-item-num">7.2&nbsp;&nbsp;</span>反向二次插值法(Inverse Quadratic Interpolation Method)</a></span></li><li><span><a href="#Brent法（Brent's-Method）" data-toc-modified-id="Brent法（Brent's-Method）-7.3"><span class="toc-item-num">7.3&nbsp;&nbsp;</span>Brent法（Brent's Method）</a></span><ul class="toc-item"><li><span><a href="#Preparing-initial-values-and-conditions" data-toc-modified-id="Preparing-initial-values-and-conditions-7.3.1"><span class="toc-item-num">7.3.1&nbsp;&nbsp;</span>Preparing initial values and conditions</a></span></li><li><span><a href="#The-iterative-process" data-toc-modified-id="The-iterative-process-7.3.2"><span class="toc-item-num">7.3.2&nbsp;&nbsp;</span>The iterative process</a></span></li><li><span><a href="#Finding-b_{k+1}" data-toc-modified-id="Finding-b_{k+1}-7.3.3"><span class="toc-item-num">7.3.3&nbsp;&nbsp;</span>Finding b_{k+1}</a></span></li><li><span><a href="#Rate-of-convergence" data-toc-modified-id="Rate-of-convergence-7.3.4"><span class="toc-item-num">7.3.4&nbsp;&nbsp;</span>Rate of convergence</a></span></li></ul></li></ul></li><li><span><a href="#利用Python对函数进行求根" data-toc-modified-id="利用Python对函数进行求根-8"><span class="toc-item-num">8&nbsp;&nbsp;</span>利用Python对函数进行求根</a></span></li><li><span><a href="#小结" data-toc-modified-id="小结-9"><span class="toc-item-num">9&nbsp;&nbsp;</span>小结</a></span></li><li><span><a href="#习题和讨论" data-toc-modified-id="习题和讨论-10"><span class="toc-item-num">10&nbsp;&nbsp;</span>习题和讨论</a></span></li></ul></div><div class="section" id="id1">
<h2>引言<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>对函数<span class="math notranslate nohighlight">\(f(x)\)</span>而言，其<strong>根</strong>或者<strong>零点</strong>是使得
\begin{equation}
f(x_r)=0
\end{equation}
的<span class="math notranslate nohighlight">\(x_r\)</span>，这里<span class="math notranslate nohighlight">\(x_r\)</span>可以为<strong>实数</strong>或者<strong>复数</strong>。</p>
<p>1） 对一些函数而言，我们可以列出函数的根的解析表达式。例如函数
\begin{equation}
f(x) = x^2 -9
\end{equation}
而言，其根为<span class="math notranslate nohighlight">\(x_1 = 3,\quad x_2 = -3\)</span>。</p>
<p>2） 而对于另外的一些函数，我们无法列出函数的根的解析表达式。例如，对函数
\begin{equation}
f(x) = \cos(x)  - x
\end{equation}
而言，我们无法写出根的解析表达式。</p>
<p>3） 另一些情况下，函数的形式特别复杂，根的解析表达式也比较复杂，无法精确获知。例如，对于解析根
\begin{equation}
x_r = \frac{e^{2\pi/5} + \sin(5\pi/7) }{20 + \cos(3\pi/7) }
\end{equation}
尽管我们能够获得解析表达式，但是该表达式比较复杂，我们往往更关注<span class="math notranslate nohighlight">\(x_r\)</span>的具体数值。这就必须借助于数值计算。因为我们看到，该表达式中涉及到的无理数<span class="math notranslate nohighlight">\(\pi\)</span>和<span class="math notranslate nohighlight">\(e\)</span>并没有解析计算方法，需要依靠数值计算的方法获得给定精度的近似值。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="c1"># four examples of nonlinear functions</span>
<span class="n">f1</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">f2</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">f3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span>
<span class="n">f4</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">50</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># plot each function</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span><span class="p">,</span> <span class="n">f4</span><span class="p">]):</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$f(x)=x^2-x-1$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$f(x)=x^3-3\sin(x)$&#39;</span><span class="p">,</span>
          <span class="sa">r</span><span class="s1">&#39;$f(x)=\exp(x)-2$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$f(x)=\sin\left(50/(1+x^2)\right)+1-x^2$&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">titles</span><span class="p">):</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="c1"># fig.savefig(&#39;ch5-nonlinear-plot-equations.pdf&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_7_0.png" src="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_7_0.png" />
</div>
</div>
<p>这时，利用数值方式获得某个函数的根的近似值是很有必要的。</p>
</div>
<div class="section" id="tolerance">
<h2>容差（Tolerance）<a class="headerlink" href="#tolerance" title="Permalink to this headline">¶</a></h2>
<p>在工程实践中，有几组关于计算或者测量的结果的精确程度的描述的名词需要关注：</p>
<ul class="simple">
<li><p>准确度（Accuracy）和精密度（Precision）；</p></li>
<li><p>误差（Error）和容差（Tolerance）；</p></li>
</ul>
<div class="section" id="id2">
<h3>准确度和精密度<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>在工程测量和计算过程中，准确度和精密度是用来衡量测量/计算的质量的重要参数</p>
<ul class="simple">
<li><p><strong>准确度</strong>刻画了近似值与精确值之间的接近程度。</p></li>
<li><p><strong>精密度</strong>刻画了近似值本身的精确程度，可以理解为表示近似值的数值的有效位数等等。</p></li>
</ul>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="accuracy-and-precision-png">
<h1><img alt="Accuracy_and_Precision.png" src="images/Accuracy_and_Precision.jpeg" /><a class="headerlink" href="#accuracy-and-precision-png" title="Permalink to this headline">¶</a></h1>
<p>(a) inaccurate and imprecise, (b) accurate and imprecise,(c) Inaccurate and precise, (d) accurate and precise</p>
<div class="section" id="id3">
<h2>误差、精度和容差<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>具体到数值计算领域，我们一般不用准确度和精密度的概念，转而采用针对性更强的<strong>误差</strong>、<strong>精度</strong>和<strong>容差</strong>的概念</p>
<ul class="simple">
<li><p><strong>误差</strong>衡量了近似值与精确值之间的偏离程度。从这个意义上来说，误差和准确度是同一个对象的不同方面。</p></li>
<li><p><strong>精度</strong>表示了近似值本身的数值精确程度，是衡量一个数在计算机中的表示准确度的重要指标。</p></li>
<li><p><strong>容差</strong>表示了我们对给定误差度量的容许程度，相当于在实际应用中给定了误差的允许上限。</p></li>
</ul>
</div>
<div class="section" id="bisection-method">
<h2>二分法（Bisection Method）<a class="headerlink" href="#bisection-method" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id4">
<h3>二分法的基本原理<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>二分法是非线性方程求根的最简单的办法。其基本原理是，首先确定方程的一个有根区间，然后通过不断地对有原有根区间进行二分，并确定所获得的两个子区间中的新的有根子区间。理论上，只要能够确定初始的有根区间，一定能够通过二分法获得任意精度的解。</p>
<p>根据以上描述，可以获得二分法的算法流程如下：</p>
<ol class="simple">
<li><p>确定一个有根区间<span class="math notranslate nohighlight">\([a_0,b_0]\)</span>，使得它满足<span class="math notranslate nohighlight">\(f(a_0) f(b_0) &lt;0\)</span>;</p></li>
<li><p>计算区间的中点<span class="math notranslate nohighlight">\(m_0 = \frac{a_0+b_0}{2}\)</span>并求<span class="math notranslate nohighlight">\(f(m_0)\)</span>的值；</p></li>
<li><p>利用二分法求得下一个有根区间<span class="math notranslate nohighlight">\([a_1,b_1]\)</span>：</p>
<ol class="simple">
<li><p>如果<span class="math notranslate nohighlight">\(f(a_0) f(m_0) &lt;0\)</span>，则取<span class="math notranslate nohighlight">\(a_1 = a_0\)</span>, <span class="math notranslate nohighlight">\(b_1 = m_0\)</span>，新的有根区间为<span class="math notranslate nohighlight">\([a_1,b_1]\)</span>.</p></li>
<li><p>如果<span class="math notranslate nohighlight">\(f(m_0) f(b_0) &lt;0\)</span>，则取<span class="math notranslate nohighlight">\(a_1 = m_0\)</span>, <span class="math notranslate nohighlight">\(b_1 = b_0\)</span>，新的有根区间为<span class="math notranslate nohighlight">\([a_1,b_1]\)</span>.</p></li>
</ol>
</li>
<li><p>重复第(2)和第(3)步直到获得最终的有根区间<span class="math notranslate nohighlight">\([a_N,b_N]\)</span>.</p></li>
<li><p>求得最终有根区间<span class="math notranslate nohighlight">\([a_N,b_N]\)</span>的中点<span class="math notranslate nohighlight">\(m_N = \frac{a_N+b_N}{2}\)</span>作为根的最终近似解。</p></li>
</ol>
<p><strong>!TIPS：</strong> 上述二分法的执行过程需要设定一个结束条件，原因有二。一是求根的最终目的是利用合理的资源获得一定精度的根。这里面涉及到计算机的时间和内存消耗，以及所求根的精度。这些是对二分法实际使用的限制。二是计算机的有限精度存储和计算过程，使得二分过程本质上也无法获得完全精确的解，这也使得有限的二分法执行过程，或者说后续的其他迭代计算过程。</p>
<p><strong>!TIPS：</strong> 常见的执行过程结束条件可以从三个方面来设定：</p>
<ol class="simple">
<li><p>所求的数值近似根<span class="math notranslate nohighlight">\(x_s\)</span>与方程的理论精确根<span class="math notranslate nohighlight">\(x_r\)</span>之间的差距满足一定的条件，即
\begin{equation}
|x_s - x_r| \leq tolroot
\end{equation}
其中<strong>tolroot</strong>是人为设定的根近似程度要求。</p></li>
<li><p>所求的数值近似根<span class="math notranslate nohighlight">\(x_s\)</span>使得原函数<span class="math notranslate nohighlight">\(f(x)\)</span>的绝对值满足一定条件，即
\begin{equation}
|f(x_s)| \leq tolfunc
\end{equation}
其中<strong>tolfunc</strong>是人为设定的函数值<span class="math notranslate nohighlight">\(f(x)\)</span>为零的判别条件。</p></li>
<li><p>二分迭代次数<span class="math notranslate nohighlight">\(N\)</span>不超过预先设定的最大迭代次<strong>maxiter</strong>，主要是为了防止出现未知bug，也是为了获得对程序执行时间的控制。</p></li>
</ol>
<p><strong>!TIPS：</strong> 大多数的情况下，其实在程序中不太关注函数值<span class="math notranslate nohighlight">\(𝑓(𝑥)\)</span>为零的判别条件，而是直接采用python本身内置的零值判定标准。这是由一般计算机的<span class="math notranslate nohighlight">\(Finite\ Precision\ Computation\)</span>机制决定的。计算机中能够表示的数并不是真的和实数一样在数轴上是均匀连续分布的，而是离散的，相邻两个可表示实数之间的差也是不定的。这就造成了一个后果，给定一个机器可表示的实数<span class="math notranslate nohighlight">\(x_c\)</span>，与其差距最小的两个实数分别为<span class="math notranslate nohighlight">\(x_l\)</span>和<span class="math notranslate nohighlight">\(x_r\)</span>。</p>
<p>具体到求根而言，一般需要关注如何判断函数值为零。而在一般的有限精度表示系统中，与零最接近的数的大小表示了改表示系统的机械精度，一般用<span class="math notranslate nohighlight">\(eps\)</span>表示。在python的numpy数值计算包中，可以获得某一个表示浮点数的数据类型的机械精度如下：<strong>np.finfo(np.float64).eps</strong>。实际的工程应用中，其实大多数时候并不需要那么高精度的零值判断。因此，一般会人为设置一个零值判断精度。</p>
<p><strong>!TIPS：</strong> 对求根而言，我们的目的寻找<span class="math notranslate nohighlight">\(x_r\)</span>使得<span class="math notranslate nohighlight">\(f(x_r)=0\)</span>。</p>
<ul class="simple">
<li><p>但实际上在有限精度计算机中我们只能使得<span class="math notranslate nohighlight">\(f(x_r)\)</span>尽可能接近<span class="math notranslate nohighlight">\(0\)</span>。因此，从求根误差的角度，<span class="math notranslate nohighlight">\(|f(x_r)|\)</span>是一个可选的度量。原则上<span class="math notranslate nohighlight">\(|f(x_r)|\)</span>越小，<span class="math notranslate nohighlight">\(x_r\)</span>越接近于精确根<span class="math notranslate nohighlight">\(x_s\)</span>。</p></li>
<li><p>此外在迭代求根的过程中，我们会在每一个迭代步获得精确根<span class="math notranslate nohighlight">\(x_s\)</span>的一个近似值<span class="math notranslate nohighlight">\(x_i\)</span>。在算法设计合理的情况下，<span class="math notranslate nohighlight">\(|x_{i+1} - x_i|\)</span>是另一个可能的求根误差的度量。原因在于，合理的算法设计会使得<span class="math notranslate nohighlight">\(x_i\)</span>随着<span class="math notranslate nohighlight">\(i\)</span>的不断增加越来越接近精确根<span class="math notranslate nohighlight">\(x_s\)</span>，从而使得<span class="math notranslate nohighlight">\(|x_{i+1} - x_i|\)</span>越来越小。（这个观察其实来源于数列极限的相关定理，也来源于有关数列极限定理的<span class="math notranslate nohighlight">\(Cauchy\)</span>方式。）</p></li>
<li><p>当然，如果我们能够找到一中方式在迭代计算的过程中定量的描述<span class="math notranslate nohighlight">\(|x_i - x_s|\)</span>的上限，那么我们实际上也可以近似用这个上限来表征每一步迭代获得的近似解<span class="math notranslate nohighlight">\(x_i\)</span>与精确解<span class="math notranslate nohighlight">\(x_s\)</span>之间的差距。</p></li>
<li><p><strong>例</strong>：假定求根误差用<span class="math notranslate nohighlight">\(e = |f(x)|\)</span>来衡量，并用<span class="math notranslate nohighlight">\(tol\)</span>来表示可接受的误差的大小。也就是说，当某个数<span class="math notranslate nohighlight">\(x_r\)</span>满足<span class="math notranslate nohighlight">\(e = |f(x_r)| \leq tol\)</span>时，我们可以认为在可接受的误差范围内，我们找到了一个近似根<span class="math notranslate nohighlight">\(x_r\)</span>。那么如果令<span class="math notranslate nohighlight">\(f(x) = x^2 + tol / 2\)</span>，很明显<span class="math notranslate nohighlight">\(f(x)\)</span>没有实根。但是考虑到<span class="math notranslate nohighlight">\(|f(0)| = |tol/2| \leq tol\)</span>，满足设定的求根条件，我们可以认为在利用程序求根时，<span class="math notranslate nohighlight">\(x_r=0\)</span>时函数<span class="math notranslate nohighlight">\(f(x)\)</span>的一个零点。 <span style="color:red"> 这里请注意，我们的计算机程序有可能对一个本来理论上没有实数根的函数求出一个实数根 </span>.</p></li>
<li><p><strong>例</strong>：假定求根误差用<span class="math notranslate nohighlight">\(e = |x_{i+1} - x_i|\)</span>来衡量，并用<span class="math notranslate nohighlight">\(tol\)</span>来表示可接受的误差的大小。考虑函数<span class="math notranslate nohighlight">\(f(x)= 1/ x\)</span>，很明显<span class="math notranslate nohighlight">\(f(x)\)</span>没有实数根。但是，某个计算机程序在第<span class="math notranslate nohighlight">\(i\)</span>步计算时获得<span class="math notranslate nohighlight">\(x_i = -tol/4\)</span>，在第<span class="math notranslate nohighlight">\(i+1\)</span>步计算时获得<span class="math notranslate nohighlight">\(x_{i+1} = tol/4\)</span>，那么所得的误差为<span class="math notranslate nohighlight">\(e = |x_{i+1} - x_i|=tol/2 \leq tol\)</span>，因此可以认为第<span class="math notranslate nohighlight">\(i+1\)</span>迭代获得的近似根为原函数<span class="math notranslate nohighlight">\(f(x)\)</span>的一个根。
<span style="color:red"> 这里请注意，我们的计算机程序有可能对一个本来理论上没有实数根的函数求出一个实数根 </span>.</p></li>
</ul>
<p><strong>!TIPS：</strong> 在实际计算和编程过程中，需要注意的是初始下标的数值。如果初始下标为<span class="math notranslate nohighlight">\([a_0,b_0]\)</span>，则最终的迭代次数和下标相等；如果初始下标为<span class="math notranslate nohighlight">\([a_1,b_1]\)</span>，则最终的迭代次数等与下标减1。关于在最终考试中的取法，请参考教材上的惯例。</p>
</div>
<div class="section" id="id5">
<h3>二分法的示例<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p><strong>例(1)</strong> 考虑函数
\begin{equation}
f(x) = x^3 + x^2 - 5
\end{equation}
<strong>求解初始有根区间</strong>。</p>
<p><strong>解：</strong></p>
<ul class="simple">
<li><p>首先，很明显函数<span class="math notranslate nohighlight">\(f(x)\)</span>是一个连续函数</p></li>
<li><p>其次，根据简单的数值计算可知<span class="math notranslate nohighlight">\(f(1) = -3 &lt;0\)</span>, <span class="math notranslate nohighlight">\(f(2) = 7 &gt;0\)</span></p></li>
<li><p>再次，考虑<span class="math notranslate nohighlight">\(f(x)\)</span>的导函数<span class="math notranslate nohighlight">\(f'(x) = 3x^2 + 2x\)</span>在区间<span class="math notranslate nohighlight">\([1,2]\)</span>上恒大于零，对应于<span class="math notranslate nohighlight">\(f(x)\)</span>的严格单调递增</p></li>
<li><p>最后，根据以上结果和介值定理，我们可以得到<span class="math notranslate nohighlight">\(f(x)\)</span>在有根区间<span class="math notranslate nohighlight">\([1,2]\)</span>上存在唯一的实根</p></li>
</ul>
<p><strong>例(2)</strong> 考虑函数
\begin{equation}
f(x) = x^3 - x - 1
\end{equation}</p>
<p>首先，可以获得<span class="math notranslate nohighlight">\(f(x)\)</span>的有根区间为<span class="math notranslate nohighlight">\([1,2]\)</span>，且<span class="math notranslate nohighlight">\(f(x)\)</span>在有根区间上的根唯一。</p>
<p>其次，针对有根区间<span class="math notranslate nohighlight">\([1,2]\)</span>，要求近似解与精确解之间的差距不大于<span class="math notranslate nohighlight">\(10^{-3}\)</span>。</p>
<p>使用二分法进行迭代求根计算的过程如下（注意改表格中初始迭代下标为0）：</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p><div style="width:10pt"> <span class="math notranslate nohighlight">\(k\)</span>  </div></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(a_k\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(b_k\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(x_k\)</span></p></th>
<th class="text-align:right head"><p><div style="width:30pt"> <span class="math notranslate nohighlight">\(f(x_k)\)</span>  </div></p></th>
<th class="text-align:center head"><p><div style="width:80pt"> <span class="math notranslate nohighlight">\(f(x_k)\)</span>的符号  </div></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>1.5</p></td>
<td class="text-align:right"><p>0.8750000000</p></td>
<td class="text-align:center"><p>+</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>1.5</p></td>
<td><p>1.25</p></td>
<td class="text-align:right"><p>-0.2968750000</p></td>
<td class="text-align:center"><p>-</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>1.25</p></td>
<td><p>1.5</p></td>
<td><p>1.375</p></td>
<td class="text-align:right"><p>0.224609375</p></td>
<td class="text-align:center"><p>+</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>1.25</p></td>
<td><p>1.375</p></td>
<td><p>1.3125</p></td>
<td class="text-align:right"><p>-0.0515136719</p></td>
<td class="text-align:center"><p>-</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>1.3125</p></td>
<td><p>1.375</p></td>
<td><p>1.3438</p></td>
<td class="text-align:right"><p>0.0826110840</p></td>
<td class="text-align:center"><p>+</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>1.3125</p></td>
<td><p>1.3438</p></td>
<td><p>1.3282</p></td>
<td class="text-align:right"><p>0.0145759583</p></td>
<td class="text-align:center"><p>+</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>1.3125</p></td>
<td><p>1.3282</p></td>
<td><p>1.3204</p></td>
<td class="text-align:right"><p>-0.0187106133</p></td>
<td class="text-align:center"><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>1.31204</p></td>
<td><p>1.3282</p></td>
<td><p>1.3243</p></td>
<td class="text-align:right"><p>-0.0021279454</p></td>
<td class="text-align:center"><p>-</p></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>1.31243</p></td>
<td><p>1.3282</p></td>
<td><p>1.3263</p></td>
<td class="text-align:right"><p>0.0062088296</p></td>
<td class="text-align:center"><p>+</p></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>1.31243</p></td>
<td><p>1.3263</p></td>
<td><p>1.3253</p></td>
<td class="text-align:right"><p>0.0024835453</p></td>
<td class="text-align:center"><p>+</p></td>
</tr>
</tbody>
</table>
<p>最终获得的近似解为<span class="math notranslate nohighlight">\(x_s = 1.3253\)</span>。</p>
<p>再次，如果要求最终获得的近似解<span class="math notranslate nohighlight">\(x_s\)</span>和精确解<span class="math notranslate nohighlight">\(x_r\)</span>满足<span class="math notranslate nohighlight">\(| x_s - x_r | \leq 10^{-6}\)</span>，则所需要的最少二分迭代次数为<span class="math notranslate nohighlight">\(k\)</span>。<span class="math notranslate nohighlight">\(k\)</span>应该满足
\begin{equation}
|x_{k} - x_r| \leq \frac{b-a}{2^{k+1}} \leq 10^{-6}
\end{equation}
即
\begin{equation}
k \geq \frac{\log(b-a) + 6 \log(10) }{\log(2)} - 1 \approx 19.932.
\end{equation}
从而二分迭代<span class="math notranslate nohighlight">\(20\)</span>次即可达到精度要求。</p>
<p><strong>例(3)</strong> 使用二分法求解方程<span class="math notranslate nohighlight">\(f(x) = x^3 - x - 1 = 0\)</span>，选取初始有根区间为<span class="math notranslate nohighlight">\([1,1.5]\)</span>，则如果要求最终求根误差为<span class="math notranslate nohighlight">\(0.005\)</span>，所需要的最小迭代次数为多少？</p>
<p><strong>解：</strong> 根据前述的计算过程，可得最小迭代次数为<span class="math notranslate nohighlight">\(k\)</span></p>
<p>\begin{equation}
k \geq \frac{\log(b-a) - \log(0.005) }{\log(2)} - 1 \approx 5.644.
\end{equation}</p>
<p>从而二分迭代<span class="math notranslate nohighlight">\(6\)</span>次即可达到精度要求。</p>
</div>
<div class="section" id="python">
<h3>二分法的Python实现<a class="headerlink" href="#python" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id6">
<h4>二分法的Python函数<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Find the numerical approximation xs of the actual solution xr </span>
<span class="sd">of a function f with starting inverval [a,b]</span>
<span class="sd">Arguments:</span>
<span class="sd">    f:       A function to be sovled</span>
<span class="sd">    a:       Root-enclosing interval, left end</span>
<span class="sd">    b:       Root-enclosing interval, right end</span>
<span class="sd">    tolroot: Absolute tolerance for the root</span>
<span class="sd">                   |xs - xr| &lt; tolroot</span>
<span class="sd">    torfunc: Absolute tolerance for the function zero</span>
<span class="sd">                   | f(xs) | &lt; tolfunc</span>
<span class="sd">    maxiter: Maximum number of bisections to be done</span>
<span class="sd">Returns:</span>
<span class="sd">    The approximated root xs</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">bisection</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">tolroot</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">tolfunc</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fprint</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>  <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The interval [a,b] does not bracket a root&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">tolfunc</span><span class="p">:</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span> <span class="k">return</span> <span class="n">xs</span> 
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">tolfunc</span><span class="p">:</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span> <span class="k">return</span> <span class="n">xs</span>
    
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">xm</span> <span class="o">=</span>  <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">xm</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">tolfunc</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tolroot</span><span class="p">:</span>
            <span class="n">xs</span> <span class="o">=</span> <span class="n">xm</span><span class="p">;</span> <span class="k">return</span> <span class="n">xs</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">xm</span><span class="p">)):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">xm</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">xm</span>
        
<span class="c1">#         print(&quot;%d, %12.10f, %12.10f, %12.10f, %12.10f, %12.10f, %12.10f, %14.10f&quot; \</span>
<span class="c1">#               %(k, a, b,(b-a)/2, f(a), f(b), xm, f(xm)))</span>
        
        <span class="k">if</span> <span class="n">fprint</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;iter </span><span class="si">{0:d}</span><span class="s2">： </span><span class="si">{1:&gt;12.10f}</span><span class="s2">  </span><span class="si">{2:&gt;12.10f}</span><span class="s2"> </span><span class="si">{3:&gt;12.10f}</span><span class="s2"> </span><span class="si">{4:&gt;12.10f}</span><span class="s2"> </span><span class="si">{5:&gt;12.10f}</span><span class="s2"> </span><span class="si">{6:&gt;12.10f}</span><span class="s2">  </span><span class="si">{7:&gt;13.10f}</span><span class="s2">&quot;</span>\
              <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">xm</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xm</span><span class="p">)))</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">xm</span>
    
    <span class="k">return</span> <span class="n">xs</span>

<span class="n">g</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">bisection</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>


<span class="n">ff</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span>
<span class="n">bisection</span><span class="p">(</span><span class="n">ff</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>

<span class="n">gg</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span>  <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">bisection</span><span class="p">(</span><span class="n">gg</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">fprint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iter 1： 1.0000000000  1.5000000000 0.2500000000 -1.0000000000 0.8750000000 1.5000000000   0.8750000000
iter 2： 1.2500000000  1.5000000000 0.1250000000 -0.2968750000 0.8750000000 1.2500000000  -0.2968750000
iter 3： 1.2500000000  1.3750000000 0.0625000000 -0.2968750000 0.2246093750 1.3750000000   0.2246093750
iter 4： 1.3125000000  1.3750000000 0.0312500000 -0.0515136719 0.2246093750 1.3125000000  -0.0515136719
iter 5： 1.3125000000  1.3437500000 0.0156250000 -0.0515136719 0.0826110840 1.3437500000   0.0826110840
iter 6： 1.3125000000  1.3281250000 0.0078125000 -0.0515136719 0.0145759583 1.3281250000   0.0145759583
iter 7： 1.3203125000  1.3281250000 0.0039062500 -0.0187106133 0.0145759583 1.3203125000  -0.0187106133
iter 8： 1.3242187500  1.3281250000 0.0019531250 -0.0021279454 0.0145759583 1.3242187500  -0.0021279454
iter 9： 1.3242187500  1.3261718750 0.0009765625 -0.0021279454 0.0062088296 1.3261718750   0.0062088296
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.3251953125
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">hh</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">hh</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">hh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_40_0.png" src="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_40_0.png" />
</div>
</div>
</div>
<div class="section" id="id7">
<h4>二分法的Python实现示例<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<p>以下以函数
\begin{equation}
f(x) = x\ \cos(x) + 1
\end{equation}
为例，调用以上二分法求解函数求区间<span class="math notranslate nohighlight">\([-3,4]\)</span>内的一个根</p>
<ul class="simple">
<li><p>单纯调用显示中间迭代结果</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">x_real</span> <span class="o">=</span> <span class="n">bisection</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">fprint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_real</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iter 1： 0.5000000000  4.0000000000 1.7500000000 1.4387912809 -1.6145744835 0.5000000000   1.4387912809
iter 2： 0.5000000000  2.2500000000 0.8750000000 1.4387912809 -0.4133906511 2.2500000000  -0.4133906511
iter 3： 1.3750000000  2.2500000000 0.4375000000 1.2675030985 -0.4133906511 1.3750000000   1.2675030985
iter 4： 1.8125000000  2.2500000000 0.2187500000 0.5661652143 -0.4133906511 1.8125000000   0.5661652143
iter 5： 2.0312500000  2.2500000000 0.1093750000 0.0974047669 -0.4133906511 2.0312500000   0.0974047669
iter 6： 2.0312500000  2.1406250000 0.0546875000 0.0974047669 -0.1548410732 2.1406250000  -0.1548410732
iter 7： 2.0312500000  2.0859375000 0.0273437500 0.0974047669 -0.0276531839 2.0859375000  -0.0276531839
iter 8： 2.0585937500  2.0859375000 0.0136718750 0.0351755180 -0.0276531839 2.0585937500   0.0351755180
iter 9： 2.0722656250  2.0859375000 0.0068359375 0.0038319675 -0.0276531839 2.0722656250   0.0038319675
iter 10： 2.0722656250  2.0791015625 0.0034179688 0.0038319675 -0.0118934293 2.0791015625  -0.0118934293
iter 11： 2.0722656250  2.0756835938 0.0017089844 0.0038319675 -0.0040263708 2.0756835938  -0.0040263708
2.073974609375
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>调用计算最终结果并且可视化</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
          
<span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">x_real</span> <span class="o">=</span> <span class="n">bisection</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x_real = &quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{:7.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_real</span><span class="p">))</span>            
<span class="c1"># 绘制结果</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$f(x) = x \ cosx + 1$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_real</span><span class="p">,</span> <span class="n">fun</span><span class="p">(</span><span class="n">x_real</span><span class="p">),</span> <span class="s1">&#39;o-r&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Approximated root&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="s2">&quot;Times New Roman&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f(x) = x\ cosx + 1$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="s2">&quot;Times New Roman&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Root finding by bisection&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="s2">&quot;Times New Roman&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x_real =  2.073975
</pre></div>
</div>
<img alt="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_45_1.png" src="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_45_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="id8">
<h3>思考题<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>考虑方程
$<span class="math notranslate nohighlight">\(x^5=x^2+10\)</span>$</p>
<ol class="simple">
<li><p>确定一个区间<span class="math notranslate nohighlight">\([a,b]\)</span>，使得区间长度为<span class="math notranslate nohighlight">\(1\)</span>，而且其中存在该方程的一个根。</p></li>
<li><p>根据所确定的初始区间，利用二分法进行两次迭代计算，获得对应的有跟区间。</p></li>
<li><p>确定求得绝对误差不超过<span class="math notranslate nohighlight">\(10^{-10}\)</span>的根所需要的二分迭代操作的次数。</p></li>
<li><p>利用上述的二分法代码，求得绝对误差不超过<span class="math notranslate nohighlight">\(10^{-10}\)</span>的根。</p></li>
</ol>
</li>
</ol>
<ol class="simple">
<li><p>Find the 4th approximation of the positive root of the function <span class="math notranslate nohighlight">\(f(x)=x^4−7\)</span> using the bisection method .</p></li>
</ol>
<ol class="simple">
<li><p>Find the third approximation of the root of the function <span class="math notranslate nohighlight">\(f(x)=\frac{1}{2}x − \sqrt[3]{x+1}\)</span> using the bisection method .</p></li>
</ol>
<ol class="simple">
<li><p>Approximate the negative root of the function <span class="math notranslate nohighlight">\(f(x)=x^2−7\)</span> to within <span class="math notranslate nohighlight">\(0.1\)</span> of its actual value.</p></li>
</ol>
<ol class="simple">
<li><p>黄金分割比
$<span class="math notranslate nohighlight">\(\phi = \frac{\sqrt{5} - 1}{2} \approx 0.618\cdots \)</span><span class="math notranslate nohighlight">\(
是函数\)</span>f(x)= x^2 - x - 1<span class="math notranslate nohighlight">\(的一个根。选定初始有根区间\)</span>[1,2]<span class="math notranslate nohighlight">\(，求迭代计算次数\)</span>N=25$后的近似区间和近似根。</p></li>
</ol>
<ol class="simple">
<li><p>Approximate the value of the root of <span class="math notranslate nohighlight">\(f(x)=−3x^3+5x^2+14x−16\)</span> near <span class="math notranslate nohighlight">\(x=3\)</span> to within <span class="math notranslate nohighlight">\(0.05\)</span> of its actual value.</p></li>
</ol>
<ol class="simple">
<li><p>Find the 4th approximation to the solution of the equation below using the bisection method .
$<span class="math notranslate nohighlight">\(x^2−x−2=x\)</span>$</p></li>
</ol>
<ol class="simple">
<li><p>Find the 5th approximation to the solution to the equation below, using the bisection method .
$<span class="math notranslate nohighlight">\(x^4−2=x+1\)</span>$</p></li>
</ol>
<ol class="simple">
<li><p>The equation below should have a solution that is larger than 5. Use the bisection method to approximate this solution to within <span class="math notranslate nohighlight">\(0.1\)</span> of its actual value.
$<span class="math notranslate nohighlight">\(x^3+18x−6=9x^2−2x+7\)</span>$</p></li>
</ol>
</div>
</div>
<div class="section" id="fixed-point-iteration-method">
<h2>不动点迭代法 （Fixed-Point Iteration Method）<a class="headerlink" href="#fixed-point-iteration-method" title="Permalink to this headline">¶</a></h2>
<p>前述的二分法向我们展示了非线性方程求根的一种方法。二分法有很多种解读的角度。</p>
<ul class="simple">
<li><p>一是我们从实际操作上讲，利用了不断对有限区间进行长度对分，最终使得包含根的区间长度越来越小，区间中点所对应的数也就越来越接近于非线性方程的根。</p></li>
<li><p>二是可以从迭代的角度来讲，二分法实际上是寻求一个近似序列<span class="math notranslate nohighlight">\(x_i\)</span> <span class="math notranslate nohighlight">\(\{ x_i \}_{i=1}^{\infty}\)</span>，使得该近似序列的极限趋于方程的精确解<span class="math notranslate nohighlight">\(x_r\)</span>
\begin{equation}
\lim_{n \to \infty} x_i = x_r
\end{equation}
从这个角度来讲，二分法的操作流程相当于确定了一个由<span class="math notranslate nohighlight">\(x_i\)</span>到<span class="math notranslate nohighlight">\(x_{i+1}\)</span>的变换规则。</p></li>
</ul>
<p>从更大的范围来讲，利用计算机进行数值计算时，经常或者说必须采用的一种思路就是<strong>迭代法</strong>，也就是通过建立由某一个近似解获得另一个近似解的方法
\begin{equation}
x_i  \Longrightarrow_{(by\ some\ rules)} x_{i+1}
\end{equation}
（也就是<strong>迭代规则</strong>），构造一个近似序列
\begin{equation}
{ x_i }_{i=1}^{\infty}
\end{equation}
（也就是<strong>迭代序列</strong>），最后只要经过合理的算法设计，使得迭代序列的极限是所需要求的精确解即可。</p>
<div class="section" id="id9">
<h3>不动点迭代法的基本原理<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p><strong>不动点迭代法</strong>的核心是通过对非线性方程
\begin{equation}
f(x) = 0
\end{equation}
进行改造获得一个合适的迭代规则
\begin{equation}
x = g(x)
\end{equation}
又称为<strong>迭代函数</strong>，从而获得迭代格式
\begin{equation}
x_{i+1} = g(x_i),\quad i =0,1,2,\cdots
\end{equation}
及对应的迭代序列
\begin{equation}
x_0, x_1, x_2, \cdots, x_i, x_{i+1}, \cdots
\end{equation}</p>
</div>
<div class="section" id="id10">
<h3>不动点迭代法的示例<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p><strong>例1</strong>  用不动点迭代法求解方程
$<span class="math notranslate nohighlight">\(x^2 - 10 =  0\)</span>$</p>
<p><strong>解</strong></p>
<ul class="simple">
<li><p>首先是要构造迭代函数<span class="math notranslate nohighlight">\(x=g(x)\)</span>。针对给出的方程，我们在这里选出的迭代函数是
\begin{equation}
f(x) = x^2 - 10 =  0 \Longrightarrow  x = \frac{1}{2}\left( x + \frac{10}{x} \right) = g(x)
\end{equation}</p></li>
<li><p>从而我们获得的迭代格式是
\begin{equation}
x_{i+1} = \frac{1}{2}\left( x_i + \frac{10}{x_i} \right)
\end{equation}</p></li>
<li><p>选定一个迭代计算用的初始值。这里我们简单的选<span class="math notranslate nohighlight">\(x_0 = 1\)</span></p></li>
<li><p>依次进行迭代计算可得<span class="math notranslate nohighlight">\(x_1\)</span>,<span class="math notranslate nohighlight">\(x_2\)</span>,<span class="math notranslate nohighlight">\(\cdots\)</span>, <span class="math notranslate nohighlight">\(x_9\)</span>如下  <br></p></li>
</ul>
<blockquote>
<div><p>x[0] :=   1.00000000 <br>
x[1] :=   5.50000000 <br>
x[2] :=   3.65909091 <br>
x[3] :=   3.19600508 <br>
x[4] :=   3.16245562 <br>
x[5] :=   3.16227767 <br>
x[6] :=   3.16227766 <br>
x[7] :=   3.16227766 <br>
x[8] :=   3.16227766 <br>
x[9] :=   3.16227766 <br></p>
</div></blockquote>
<p>对应的python代码如下</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">g</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">10.0</span><span class="o">/</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x[</span><span class="si">%d</span><span class="s2">] := </span><span class="si">%12.8f</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
<p><strong>例2</strong>  用不动点迭代法求解方程
$<span class="math notranslate nohighlight">\(x^3 - x - 1 =  0\)</span>$</p>
<p><strong>解</strong> 首先可以画出该函数的图像如下：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">g</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;g(x0)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_63_0.png" src="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_63_0.png" />
</div>
</div>
<p>其次，我们可以构造出三种迭代函数
\begin{equation}
g_1 (x) = \sqrt[3]{x+1},\quad g_2 (x) = x^3 - 1，\quad g_3(x) = \frac{x+1}{x^2}
\end{equation}
<strong>!TIPS</strong> 请验证一下<span class="math notranslate nohighlight">\(g_1(x)\)</span>，<span class="math notranslate nohighlight">\(g_2(x)\)</span>和<span class="math notranslate nohighlight">\(g_3(x)\)</span>符合上述方程。</p>
<p>再次，选取初始值<span class="math notranslate nohighlight">\(x_0=1.5\)</span>，可以对上述迭代公式进行迭代求解，获得如下表的结果</p>
<p>|迭代公式  | <span class="math notranslate nohighlight">\(g_1(x)\)</span>   |   <span class="math notranslate nohighlight">\(g_2(x)\)</span>   |    <span class="math notranslate nohighlight">\(g_3(x)\)</span>   |
|—|– -|— | — |
|<span class="math notranslate nohighlight">\(x_0\)</span>| 1.50000000 |  1.50000000 |  1.50000000 |
|<span class="math notranslate nohighlight">\(x_1\)</span>| 1.35720881 |  2.37500000 |  1.11111111 |
|<span class="math notranslate nohighlight">\(x_2\)</span>| 1.33086096 | 12.39648438 |  1.71000000 |
|<span class="math notranslate nohighlight">\(x_3\)</span>| 1.32588377 |1904.00277223 |  0.92678089 |
|<span class="math notranslate nohighlight">\(x_4\)</span>| 1.32493936 |6902441412.88919163 |  2.24325265 |
|<span class="math notranslate nohighlight">\(x_5\)</span>| 1.32476001 |328857830399801008433274028032.00000000 |  0.64450220 |
|<span class="math notranslate nohighlight">\(x_6\)</span>| 1.32472595 | — |  3.95900139 |
|<span class="math notranslate nohighlight">\(x_7\)</span>| 1.32471947 |— |  0.31639013 |
|<span class="math notranslate nohighlight">\(x_8\)</span>| 1.32471825 |         inf | 13.15039424 |
|<span class="math notranslate nohighlight">\(x_9\)</span>| 1.32471801 |         inf |  0.08182594 |</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">g1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">g2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mf">3.0</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">g3</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">x</span><span class="o">**</span><span class="mf">2.0</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">x1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
<span class="n">x2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
<span class="n">x3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">)):</span>
    <span class="n">x1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">g1</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">x2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">g2</span><span class="p">(</span><span class="n">x2</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">x3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">g3</span><span class="p">(</span><span class="n">x3</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%12.8f</span><span class="s2"> |</span><span class="si">%12.8f</span><span class="s2"> |</span><span class="si">%12.8f</span><span class="s2"> |&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x3</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
<p><strong>!TIPS</strong> 根据以上过程可知，<font color=red><span class="math notranslate nohighlight">\(g(x)\)</span>的选择对于最终是否能够顺利求得精确解，甚至说能否求得一个解至关重要</font>。</p>
</div>
<div class="section" id="id11">
<h3>不动点迭代法的收敛性<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p>从几何上看，不动点迭代法的操作过程是求函数<span class="math notranslate nohighlight">\(y=g(x)\)</span>与直线<span class="math notranslate nohighlight">\(y=x\)</span>的交点<span class="math notranslate nohighlight">\(P\)</span>的横坐标<span class="math notranslate nohighlight">\(x_p\)</span>。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mf">3.0</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;r--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$y=x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$y=x^3 - 1$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_69_0.png" src="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_69_0.png" />
</div>
</div>
<p>通过前面的示例，我们能够很明确的发现：利用不动点迭代法<span class="math notranslate nohighlight">\(x_{k+1} = g(x_k)\)</span>求非线性方程<span class="math notranslate nohighlight">\(f(x)=0\)</span>的根时，<span class="math notranslate nohighlight">\(g(x)\)</span>的形式决定了迭代过程的收敛特性以及最终结果的准确性。下图表示了不同<span class="math notranslate nohighlight">\(g(x)\)</span>所对应的迭代过程。</p>
<p><img alt="fixed_point_example.jpg" src="images/fixed_point_example.jpg" /></p>
<div class="section" id="id12">
<h4>全局收敛性判断定理<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p><strong>定理（不动点迭代法的收敛性条件）</strong>  设函数<span class="math notranslate nohighlight">\(\varphi(x)\)</span>在闭区间<span class="math notranslate nohighlight">\([a,b]\)</span>上连续，并且满足</p>
<p><a name="item:theorem1_condition1"></a> <font color="red">条件1</font>: 对任意的<span class="math notranslate nohighlight">\(x\in [a,b]\)</span>，都有<span class="math notranslate nohighlight">\(\varphi(x) \in [a,b]\)</span>；</p>
<p><a name="item:theorem1_condition2"></a> <font color="red">条件2</font>: 存在正数<span class="math notranslate nohighlight">\(L &lt; 1\)</span>，使得对任意<span class="math notranslate nohighlight">\(x,y \in [a,b]\)</span>，有：
\begin{equation*}
|\varphi(x) - \varphi(y)| \leq L |x-y|.
\end{equation*}</p>
<p>则对于方程<span class="math notranslate nohighlight">\(x = \varphi(x)\)</span>而言，有</p>
<p><a name="item:theorem1_result1"></a> <font color="blue">结论1</font>：函数<span class="math notranslate nohighlight">\(\varphi(x)\)</span>在闭区间<span class="math notranslate nohighlight">\([a,b]\)</span>上存在唯一的不动点<span class="math notranslate nohighlight">\(x^*\)</span>；</p>
<p><a name="item:theorem1_result2"></a> <font color="blue">结论2</font>：对于任何初值<span class="math notranslate nohighlight">\(x_0 \in [a,b]\)</span>，由迭代法<span class="math notranslate nohighlight">\(x_{k+1} = \varphi(x_k)\)</span>生成的序列<span class="math notranslate nohighlight">\(\{x_k\}\)</span>收敛到不动点<span class="math notranslate nohighlight">\(x^*\)</span>；</p>
<p><a name="item:theorem1_result3"></a> <font color="blue">结论3</font>：存在如下的误差估计式
\begin{equation*}
|x_k - x^<em>| \leq \frac{L}{1-L}|x_k - x_{k-1}|.
\end{equation</em>}
\begin{equation*}
|x_k - x^<em>| \leq \frac{L^k}{1-L}|x_1 - x_0|.
\end{equation</em>}</p>
<p><strong>证明 part 1（不动点的存在性）</strong>
根据前述情况，显然有<span class="math notranslate nohighlight">\(x_k \in [a,b],\ k=0,1,\cdots\)</span>，进而有
\begin{equation*}
\begin{aligned}
|x_k - x^<em>| &amp;= |\varphi(x_{k-1}) - \varphi(x^</em>)| \
&amp;\leq L |x_{k-1} - x^<em>| \leq \cdots \leq L^k |x_{0} - x^</em>|
\end{aligned}
\end{equation*}
从而
\begin{equation*}
\lim_{k \to \infty}|x_k - x^<em>| = 0
\end{equation</em>}
即$<span class="math notranslate nohighlight">\(\lim_{k \to \infty}x_k = x^*\)</span>$</p>
<p><strong>证明 part 2（不动点的唯一性）</strong>
现假设<span class="math notranslate nohighlight">\(\varphi(x)\)</span>在区间<span class="math notranslate nohighlight">\([a,b]\)</span>上有两个不同的不动点<span class="math notranslate nohighlight">\(x_1^*\)</span>和<span class="math notranslate nohighlight">\(x_2^*\)</span>，则有
\begin{equation*}
|x_1^* - x_2^<em>| = |\varphi(x_1^</em>) - \varphi(x_2^<em>)| \leq L |x_1^</em> - x_2^<em>| &lt; |x_1^</em> - x_2^<em>|
\end{equation</em>}
该式存在矛盾，因此<span class="math notranslate nohighlight">\(\varphi(x)\)</span>在区间<span class="math notranslate nohighlight">\([a,b]\)</span>上只有一个不动点</p>
<p><strong>证明  part 3（迭代序列的收敛性）</strong>
根据前述情况，显然有<span class="math notranslate nohighlight">\(x_k \in [a,b],\ k=0,1,\cdots\)</span>，进而有
\begin{equation*}
\begin{aligned}
|x_k - x^<em>| &amp;= |\varphi(x_{k-1}) - \varphi(x^</em>)| \
&amp;\leq L |x_{k-1} - x^<em>| \leq \cdots \leq L^k |x_{0} - x^</em>|
\end{aligned}
\end{equation*}
从而
\begin{equation*}
\lim_{k \to \infty}|x_k - x^<em>| = 0
\end{equation</em>}
即$<span class="math notranslate nohighlight">\(\lim_{k \to \infty}x_k = x^*\)</span>$</p>
<p><strong>证明  part 4（迭代序列的收误差估计）</strong>
根据前述情况，显然有
\begin{equation*}
|x_{k+1} - x_k| = |\varphi(x_{k}) - \varphi(x_{k-1})| \leq L |x_{k} - x_{k-1}|
\end{equation*}
进而，对任意的正整数<span class="math notranslate nohighlight">\(p\)</span>可得
\begin{equation*}
\begin{aligned}
|x_{k+p} - x_k| &amp;\leq |x_{k+p} - x_{k+p-1}| + \cdots + |x_{k+2} - x_{k+1}| + |x_{k+1} - x_k| \
&amp;\leq \left( L^{p-1} + \cdots + L + 1 \right) |x_{k+1} - x_k|
\end{aligned}
\end{equation*}
因为<span class="math notranslate nohighlight">\(0 &lt; L &lt; 1\)</span>，从而<span class="math notranslate nohighlight">\((1-L)^{-1} = \sum_{k=0}^\infty L^k &gt; 1 + L + \cdots + L^{p-1}\)</span>。由此，
\begin{equation*}
|x_{k+p} - x_k| \leq \frac{1}{1-L} |x_{k+1} - x_k| \leq \frac{L}{1-L} |x_{k} - x_{k-1}|
\end{equation*}
令<span class="math notranslate nohighlight">\(p \to \infty\)</span>并由前述证明的序列收敛性，即可得
\begin{equation*}
|x^* - x_k| \leq \frac{L}{1-L} |x_{k} - x_{k-1}|
\end{equation*}
继续往下迭代可知
\begin{equation*}
|x^* - x_k| \leq \frac{L}{1-L} |x_{k} - x_{k-1}| \leq \frac{L^2}{1-L} |x_{k-1} - x_{k-2}| \leq \cdots \leq \frac{L^k}{1-L} |x_{1} - x_{0}|
\end{equation*}</p>
<p><strong>!TIPS</strong> 1： 如果函数<span class="math notranslate nohighlight">\(\varphi(x)\)</span>在区间<span class="math notranslate nohighlight">\((a,b)\)</span>内可微，那么上述定理中的<a class="reference external" href="#item:theorem1_condition1">条件1</a>可以用更强的条件代替：
\begin{equation*}
|\varphi^{\prime}(x)| \leq L &lt; 1,\quad \forall x \in (a,b)
\end{equation*}
事实上，若上式成立，则根据微分中值定理，对任何<span class="math notranslate nohighlight">\(x,y \in [a,b]\)</span>都有
\begin{equation*}
|\varphi(x) - \varphi(y)| = |\varphi^{\prime}(\xi) (x-y)| \leq L(x-y),
\end{equation*}
其中<span class="math notranslate nohighlight">\(\xi\)</span>在<span class="math notranslate nohighlight">\(x\)</span>与<span class="math notranslate nohighlight">\(y\)</span>之间，从而<a class="reference external" href="#item:theorem1_condition2">条件2</a>成立。</p>
<p><strong>!TIPS</strong> 2： 以上两个结论中的收敛性与初始值的选取无关!只要初始值在区间<span class="math notranslate nohighlight">\((a,b)\)</span>内，我们都能通过迭代达到最终的准确值<span class="math notranslate nohighlight">\(x^*\)</span>，这种收敛性我们称之为全局收敛。</p>
<p><strong>!TIPS</strong> 3： 根据上述定理的<a class="reference external" href="#item:theorem1_result3">结论3</a>：
\begin{equation*}
|x_k - x^<em>| \leq \frac{L}{1-L}|x_k - x_{k-1}|.
\end{equation</em>}
只要相邻两次计算结果的偏差<span class="math notranslate nohighlight">\(|x_{k} - x_{k-1}|\)</span>足够小，且<span class="math notranslate nohighlight">\(L\)</span>不很接近于<span class="math notranslate nohighlight">\(1\)</span>，即可以保证近似值<span class="math notranslate nohighlight">\(x_k\)</span>具有足够的精度。因此，可以通过检查<span class="math notranslate nohighlight">\(|x_{k} - x_{k-1}|\)</span>的大小来判断迭代过程是否终止。</p>
<p><strong>!TIPS</strong> 4： 同样根据上述定理的<a class="reference external" href="#item:theorem1_result3">结论3</a>，我们可以得到
\begin{equation*}
|x_k - x^<em>| \leq \frac{L}{1-L}|x_k - x_{k-1}| \leq \cdots \leq \frac{L^k}{1-L}|x_1 - x_{0}|.
\end{equation</em>}
如果能恰当计算出<span class="math notranslate nohighlight">\(L\)</span>的值，我们可以由上式对给定的计算精度要求确定出所需要迭代的次数。</p>
</div>
<div class="section" id="id13">
<h4>收敛性判断示例<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<p><strong>!例</strong>： 对于方程<span class="math notranslate nohighlight">\(f(x) = x^3 - x - 1 = 0\)</span>在区间<span class="math notranslate nohighlight">\([1,2]\)</span>列出两种迭代格式，并分别分析其收敛性。</p>
<p><strong>!解</strong>：</p>
<p>第一种迭代格式为<span class="math notranslate nohighlight">\(\varphi_1(x) = \sqrt[3]{x+1}\)</span>，即
\begin{equation*}
x_{k+1} = \sqrt[3]{x_k+1}.
\end{equation*}
而其导数为<span class="math notranslate nohighlight">\(\varphi_1^\prime(x) = \frac{1}{3}(x+1)^{-2/3}\)</span>。从而，我们容易验证，对任意的<span class="math notranslate nohighlight">\(x \in [1,2]\)</span>有
\begin{equation*}
\varphi_1(x) \in [1.26, 1.45] \subset [1,2],\quad \varphi_1^\prime(x) \leq 0.21 &lt; 1.
\end{equation*}
因此，对于任何初值<span class="math notranslate nohighlight">\(x_0 \in [1,2]\)</span>，由<span class="math notranslate nohighlight">\(\varphi_1(x) \)</span>给出的迭代格式都收敛到区间<span class="math notranslate nohighlight">\([1,2]\)</span>上的唯一不动点<span class="math notranslate nohighlight">\(x^*\)</span>。</p>
<p>第二种迭代格式为<span class="math notranslate nohighlight">\(\varphi_2(x) = x^3 + 1 \)</span>，即
\begin{equation*}
x_{k+1} = x_k^3 + 1 .
\end{equation*}
而其导数为<span class="math notranslate nohighlight">\(\varphi_2^\prime(x) = 3 x^2\)</span>。显然，对于<span class="math notranslate nohighlight">\(x \in [1,2]\)</span>有
\begin{equation*}
\varphi_2(x) \in [0,7],\quad \varphi_2^\prime(x) \in [3, 12],
\end{equation*}
不满足定理的<a class="reference external" href="#item:theorem1_condition1">条件1</a>。再结合几何图形可以说明，只要初值<span class="math notranslate nohighlight">\(x_0 \neq x^*\)</span>，该迭代法发散。</p>
<p><strong>!TIPS</strong>： 有时，对于一些不满足上述定理条件的问题，可以通过转化，变成满足定理的迭代格式。这需要针对具体情况进行讨论。</p>
</div>
<div class="section" id="id14">
<h4>局部收敛性判断<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h4>
<p>前述定理讨论的是不动点迭代法的全局收敛性。但是一般而言，全局收敛性的基本条件不易检验，不容易得到满足，所以我们经常需要讨论在<span class="math notranslate nohighlight">\(x^*\)</span>附近的收敛性问题。为此，我们给出如下定义：</p>
<p><strong>!<font color='magenta'>定义</font></strong>： 设<span class="math notranslate nohighlight">\(x^*\)</span>是<span class="math notranslate nohighlight">\(\varphi(x)\)</span>的不动点，若存在<span class="math notranslate nohighlight">\(x^*\)</span>的某个<span class="math notranslate nohighlight">\(\delta\)</span>-邻域<span class="math notranslate nohighlight">\(N_\delta(x^*) = [x^* - \delta, x^* + \delta]\)</span>，<span class="math notranslate nohighlight">\(\delta &gt; 0\)</span>，使得对于任何初值<span class="math notranslate nohighlight">\(x_0 \in N_\delta(x^*)\)</span>，由迭代格式
\begin{equation*}
x_{k+1} = \varphi(x_k)
\end{equation*}
生成的序列<span class="math notranslate nohighlight">\(\{ x_k \}_{k=1}^\infty\)</span>满足：<span class="math notranslate nohighlight">\(x_k \in N_\delta(x^*)\)</span>，且收敛到<span class="math notranslate nohighlight">\(x^*\)</span>，则称该迭代格式是<font color='magenta'>局部收敛的</font>。</p>
<p><strong>!定理</strong>： 设<span class="math notranslate nohighlight">\(x^*\)</span>是<span class="math notranslate nohighlight">\(\varphi(x)\)</span>的一个不动点，<span class="math notranslate nohighlight">\(\varphi^\prime(x)\)</span>在<span class="math notranslate nohighlight">\(x^*\)</span>的某个邻域上连续，并且有<span class="math notranslate nohighlight">\(|\varphi^\prime(x^*)|&lt;1\)</span>，则迭代格式<span class="math notranslate nohighlight">\(x_{k+1} = \varphi(x_k)\)</span>是局部收敛的。</p>
<p><strong>证明</strong>
由于<span class="math notranslate nohighlight">\(\varphi^\prime(x)\)</span>在<span class="math notranslate nohighlight">\(x^*\)</span>处连续，且<span class="math notranslate nohighlight">\(|\varphi^\prime(x^*)|&lt;1\)</span>，所以存在<span class="math notranslate nohighlight">\(x^*\)</span>的某一个闭邻域<span class="math notranslate nohighlight">\([x^* - \delta, x^* + \delta]\)</span>，在其上有<span class="math notranslate nohighlight">\(|\varphi^\prime(x^*)| \leq L &lt; 1\)</span>，并且有
\begin{equation*}
|\varphi(x) - x^<em>| = |\varphi(x) - \varphi(x^</em>)| \leq L |x - x^<em>| &lt; \delta
\end{equation</em>}
即对一切<span class="math notranslate nohighlight">\(x \in [x^* - \delta, x^* + \delta]\)</span>，有<span class="math notranslate nohighlight">\(\varphi(x) \in [x^* - \delta, x^* + \delta]\)</span>。则依据全局收敛定理，对任意<span class="math notranslate nohighlight">\(x_0 \in [x^* - \delta, x^* + \delta]\)</span>，迭代格式<span class="math notranslate nohighlight">\(x_{k+1} = \varphi(x_k)\)</span>收敛。</p>
<p><strong>!<font color='magenta'>定义（收敛阶）</font></strong>： 设迭代序列<span class="math notranslate nohighlight">\(\{x_k\}\)</span>收敛到<span class="math notranslate nohighlight">\(\varphi(x)\)</span>的不动点<span class="math notranslate nohighlight">\(x^*\)</span>，记误差<span class="math notranslate nohighlight">\(e_k = x_k - x^*\)</span>。若存在实数<span class="math notranslate nohighlight">\(p \geq 1\)</span>和<span class="math notranslate nohighlight">\(C \neq 0\)</span>，使得
\begin{equation*}
\lim_{k \to \infty} \frac{e_{k+1}}{e_k^p} = C
\end{equation*}
则称该迭代序列<span class="math notranslate nohighlight">\(\{x_k\}\)</span>是<span class="math notranslate nohighlight">\(p\)</span>阶收敛的。</p>
<ul class="simple">
<li><p>当<span class="math notranslate nohighlight">\( p =1 \)</span>且<span class="math notranslate nohighlight">\( 0&lt; C &lt; 1\)</span>时称为<font color='magenta'>线性收敛</font></p></li>
<li><p>当<span class="math notranslate nohighlight">\( p =2 \)</span>时称为<font color='magenta'>二次收敛</font>，或<font color='magenta'>平方收敛</font></p></li>
<li><p>当<span class="math notranslate nohighlight">\( p &gt;1 \)</span>或<span class="math notranslate nohighlight">\( p=1\)</span>且<span class="math notranslate nohighlight">\( C=0 \)</span>时称为<font color='magenta'>超线性收敛</font></p></li>
</ul>
<p>若<span class="math notranslate nohighlight">\(0 &lt; |\varphi^\prime(x^*)| &lt; 1\)</span>，则不动点迭代<span class="math notranslate nohighlight">\(x_{k+1} = \varphi(x_k)\)</span><font color='magenta'>局部线性收敛</font>。</p>
<p><strong>!定理</strong>： 设<span class="math notranslate nohighlight">\(x^*\)</span>是<span class="math notranslate nohighlight">\(\varphi(x)\)</span>的不动点，若有正整数<span class="math notranslate nohighlight">\(p \geq 2\)</span>，使得<span class="math notranslate nohighlight">\(\varphi^{(p)}(x)\)</span>在<span class="math notranslate nohighlight">\(x^*\)</span>的邻域上连续，并且满足
\begin{equation*}
\begin{aligned}
\varphi^{\prime}(x^<em>) &amp;= \varphi^{\prime\prime}(x^</em>) = \cdots = \varphi^{(p-1)}(x^<em>) = 0, \
\varphi^{(p)}(x^</em>) &amp; \neq 0,
\end{aligned}
\end{equation*}
则称该迭代序列<span class="math notranslate nohighlight">\(\{x_k\}\)</span>是<span class="math notranslate nohighlight">\(p\)</span>阶局部收敛的，且有
\begin{equation*}
\lim_{k \to \infty}\frac{x_{k+1} - x^<em>}{(x_k - x^</em>)^p} = \frac{\varphi^{(p)}(x^<em>)}{p!}
\end{equation</em>}</p>
<p><strong>证明</strong>
因为<span class="math notranslate nohighlight">\(\varphi^\prime(x^*) = 0\)</span>，根据局部收敛定理，该迭代格式是局部收敛的。
取充分接近于<span class="math notranslate nohighlight">\(x^*\)</span>的<span class="math notranslate nohighlight">\(x_0\)</span>，设<span class="math notranslate nohighlight">\(x_0 \neq x^*\)</span>，则有<span class="math notranslate nohighlight">\(x_k \neq x^*,\ k=1,2,\cdots\)</span>.根据<span class="math notranslate nohighlight">\(Taylor\)</span>展开式，有
\begin{equation*}
\begin{aligned}
x_{k+1} &amp;= \varphi(x_k) \
&amp;= \varphi(x^<em>) + \varphi^{\prime}(x^</em>) (x_k - x^<em>) + \cdots \
&amp;+ \frac{\varphi^{(p-1)}(x^</em>)}{(p-1)!}(x_k - x^<em>)^{p-1} + \frac{\varphi^{(p)}(\xi_k)}{p!}(x_k - x^</em>)^{p}
\end{aligned}
\end{equation*}
其中<span class="math notranslate nohighlight">\(\xi_k\)</span>在<span class="math notranslate nohighlight">\(x_k\)</span>与<span class="math notranslate nohighlight">\(x^*\)</span>之间。从而根据题设条件有
\begin{equation*}
x_{k+1} - x^* = \frac{\varphi^{(p)}(\xi_k)}{p!}(x_k - x^<em>)^{p}
\end{equation</em>}
再由<span class="math notranslate nohighlight">\(\varphi^{(p)}(x)\)</span>的连续性，当<span class="math notranslate nohighlight">\(k \to \infty\)</span>时，原定理得证。</p>
<p><strong>!例</strong>： 分析方程<span class="math notranslate nohighlight">\(f(x) = x^2 - 3 = 0\)</span>的不同迭代格式在求正根<span class="math notranslate nohighlight">\(x^* = \sqrt{3}\)</span>时的收敛性。</p>
<p><strong>解</strong></p>
<ul class="simple">
<li><p>第一种格式，取<span class="math notranslate nohighlight">\(\varphi(x) = x^2 - 3 + x\)</span>，则有<span class="math notranslate nohighlight">\(\varphi^{\prime}(x^*) = 2 \sqrt{3} + 1 &gt; 1\)</span>，无法判断其局部收敛性。</p></li>
<li><p>第二种格式，取<span class="math notranslate nohighlight">\(\varphi(x) = x - \frac{x^2 - 3}{4}\)</span>，则有<span class="math notranslate nohighlight">\(\varphi^{\prime}(x^*) = 1 - \frac{\sqrt{3}}{2} &lt; 1\)</span>，迭代格式是一阶局部收敛的。</p></li>
<li><p>第三种格式，取<span class="math notranslate nohighlight">\(\varphi(x) = \frac{1}{2} \left( x + \frac{3}{x} \right)\)</span>，则有<span class="math notranslate nohighlight">\(\varphi^{\prime}(x^*) = 0,\ \varphi^{\prime\prime}(x^*) = \frac{2}{\sqrt{3}} \neq 0 \)</span>，迭代格式是二阶局部收敛的。</p></li>
</ul>
<p><strong>!TIPS</strong>： 一般而言，<span class="math notranslate nohighlight">\(|\varphi^{\prime}(x^*)|\)</span>越小，迭代格式<span class="math notranslate nohighlight">\(x_{k+1} = \varphi(x_k)\)</span>的收敛速度越快。</p>
</div>
</div>
<div class="section" id="id15">
<h3>不动点迭代法的Python实现<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">fixedPointIteration</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">iters</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">xprev</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="n">xnext</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">xprev</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;iters = </span><span class="si">{</span><span class="n">iters</span><span class="si">}</span><span class="s2">, x</span><span class="si">{</span><span class="n">iters</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">xprev</span><span class="si">:</span><span class="s2"> 0.8f</span><span class="si">}</span><span class="s2">, f(x</span><span class="si">{</span><span class="n">iters</span><span class="si">}</span><span class="s2">) = </span><span class="si">{</span><span class="n">xnext</span><span class="si">:</span><span class="s2"> 0.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xnext</span> <span class="o">-</span> <span class="n">xprev</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ROOT: </span><span class="si">{</span><span class="n">xnext</span><span class="si">}</span><span class="s1"> obtained at ITERATION: </span><span class="si">{</span><span class="n">iters</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">xnext</span>
        <span class="n">iters</span> <span class="o">=</span> <span class="n">iters</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">xprev</span> <span class="o">=</span> <span class="n">xnext</span>
        <span class="n">xnext</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">xprev</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;iters = </span><span class="si">{</span><span class="n">iters</span><span class="si">}</span><span class="s2">, x</span><span class="si">{</span><span class="n">iters</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">xprev</span><span class="si">:</span><span class="s2"> 0.8f</span><span class="si">}</span><span class="s2">, f(x</span><span class="si">{</span><span class="n">iters</span><span class="si">}</span><span class="s2">) = </span><span class="si">{</span><span class="n">xnext</span><span class="si">:</span><span class="s2"> 0.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">iters</span> <span class="o">==</span> <span class="n">maxiter</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xnext</span> <span class="o">-</span> <span class="n">xprev</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maximum iterations reached without root!&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ROOT: </span><span class="si">{</span><span class="n">xnext</span><span class="si">}</span><span class="s1"> obtained at ITERATION: </span><span class="si">{</span><span class="n">iters</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xnext</span>

<span class="n">ff</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span>
<span class="n">fixedPointIteration</span><span class="p">(</span><span class="n">ff</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iters = 0, x0 =  1.50000000, f(x0) =  1.48168907
iters = 1, x1 =  1.48168907, f(x1) =  1.40037195
iters = 2, x2 =  1.40037195, f(x2) =  1.05670856
iters = 3, x3 =  1.05670856, f(x3) = -0.12311371
iters = 4, x4 = -0.12311371, f(x4) = -2.11583688
iters = 5, x5 = -2.11583688, f(x5) = -2.87946762
iters = 6, x6 = -2.87946762, f(x6) = -2.94383534
iters = 7, x7 = -2.94383534, f(x7) = -2.94733664
iters = 8, x8 = -2.94733664, f(x8) = -2.94752071
ROOT: -2.9475207088355244 obtained at ITERATION: 9
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.9475207088355244
</pre></div>
</div>
</div>
</div>
<p>例：
\begin{equation}
f(x) = \frac{1}{2} ( \sin(x) + \cos(x) ) - x,\quad g(x) = \frac{1}{2} ( \sin(x) + \cos(x) )
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
<span class="n">fixedPointIteration</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iters = 0, x0 = -0.30000000, f(x0) =  0.32990814
iters = 1, x1 =  0.32990814, f(x1) =  0.63501412
iters = 2, x2 =  0.63501412, f(x2) =  0.69912610
iters = 3, x3 =  0.69912610, f(x3) =  0.70447696
iters = 4, x4 =  0.70447696, f(x4) =  0.70479289
ROOT: 0.7047928914757919 obtained at ITERATION: 5
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7047928914757919
</pre></div>
</div>
</div>
</div>
<p>例：
\begin{equation}
f(x) = \frac{1}{\tan(x)} - \frac{1}{x},\quad g(x) = \frac{1}{\tan(x)} - \frac{1}{x} + x
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">gg</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span>
<span class="n">xsol</span> <span class="o">=</span> <span class="n">fixedPointIteration</span><span class="p">(</span><span class="n">gg</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xsol</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;r--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">gg</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xsol</span><span class="p">,</span><span class="n">gg</span><span class="p">(</span><span class="n">xsol</span><span class="p">),</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iters = 0, x0 =  4.00000000, f(x0) =  4.61369115
iters = 1, x1 =  4.61369115, f(x1) =  4.49596452
iters = 2, x2 =  4.49596452, f(x2) =  4.49341090
iters = 3, x3 =  4.49341090, f(x3) =  4.49340946
ROOT: 4.49340945790953 obtained at ITERATION: 4
4.49340945790953
</pre></div>
</div>
<img alt="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_98_1.png" src="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_98_1.png" />
</div>
</div>
<p>例：
\begin{equation}
f(x) = \sin(\sqrt{x}) - x,\quad g(x) = \sin(\sqrt{x})
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">gg</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">xsol</span> <span class="o">=</span> <span class="n">fixedPointIteration</span><span class="p">(</span><span class="n">gg</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xsol</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$y=x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">gg</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$y=\sin(\sqrt</span><span class="si">{x}</span><span class="s1">)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xsol</span><span class="p">,</span><span class="n">gg</span><span class="p">(</span><span class="n">xsol</span><span class="p">),</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Root of $x=\sin(\sqrt</span><span class="si">{x}</span><span class="s1">)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iters = 0, x0 =  4.00000000, f(x0) =  0.90929743
iters = 1, x1 =  0.90929743, f(x1) =  0.81548744
iters = 2, x2 =  0.81548744, f(x2) =  0.78521511
iters = 3, x3 =  0.78521511, f(x3) =  0.77462609
iters = 4, x4 =  0.77462609, f(x4) =  0.77082071
iters = 5, x5 =  0.77082071, f(x5) =  0.76944002
iters = 6, x6 =  0.76944002, f(x6) =  0.76893732
ROOT: 0.7689373246910672 obtained at ITERATION: 7
0.7689373246910672
</pre></div>
</div>
<img alt="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_100_1.png" src="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_100_1.png" />
</div>
</div>
<p>例：
\begin{equation}
f(x) = \arcsin(x) - x^2,\quad g(x) = \sin(x^2)
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">gg</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">xsol</span> <span class="o">=</span> <span class="n">fixedPointIteration</span><span class="p">(</span><span class="n">gg</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xsol</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$y=x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">gg</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$y=\sin(x^2)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xsol</span><span class="p">,</span><span class="n">gg</span><span class="p">(</span><span class="n">xsol</span><span class="p">),</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Root of $x=\sin(x^2)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iters = 0, x0 =  4.00000000, f(x0) = -0.28790332
iters = 1, x1 = -0.28790332, f(x1) =  0.08279344
iters = 2, x2 =  0.08279344, f(x2) =  0.00685470
iters = 3, x3 =  0.00685470, f(x3) =  0.00004699
iters = 4, x4 =  0.00004699, f(x4) =  0.00000000
ROOT: 2.2077696573148454e-09 obtained at ITERATION: 5
2.2077696573148454e-09
</pre></div>
</div>
<img alt="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_102_1.png" src="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_102_1.png" />
</div>
</div>
<p>例：
\begin{equation}
f(x) = \sin(x) - x^3,\quad g(x) = \arcsin(x^3)
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">gg</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mf">3.0</span><span class="p">)</span>
<span class="n">xsol1</span> <span class="o">=</span> <span class="n">fixedPointIteration</span><span class="p">(</span><span class="n">gg</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xsol1</span><span class="p">)</span>
<span class="n">xsol2</span> <span class="o">=</span> <span class="n">fixedPointIteration</span><span class="p">(</span><span class="n">gg</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xsol2</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$y=x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">gg</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$y=\arcsin(x^3)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xsol1</span><span class="p">,</span><span class="n">gg</span><span class="p">(</span><span class="n">xsol1</span><span class="p">),</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Root 1 of $x=\arcsin(x^3)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iters = 0, x0 =  0.10000000, f(x0) =  0.00100000
iters = 1, x1 =  0.00100000, f(x1) =  0.00000000
ROOT: 1.000000500000309e-09 obtained at ITERATION: 2
1.000000500000309e-09
iters = 0, x0 =  0.75000000, f(x0) =  0.43551237
iters = 1, x1 =  0.43551237, f(x1) =  0.08269831
iters = 2, x2 =  0.08269831, f(x2) =  0.00056557
iters = 3, x3 =  0.00056557, f(x3) =  0.00000000
ROOT: 1.809129660057757e-10 obtained at ITERATION: 4
1.809129660057757e-10
</pre></div>
</div>
<img alt="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_104_1.png" src="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_104_1.png" />
</div>
</div>
<p>例：
\begin{equation}
f(x) = e^{-x} - 3 \ln(x),\quad g(x) = e^{-x} - 3 \ln(x) + x
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">gg</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span>
<span class="n">xsol1</span> <span class="o">=</span> <span class="n">fixedPointIteration</span><span class="p">(</span><span class="n">gg</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xsol1</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$y=x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">gg</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$y=-3\ln(x) + e^{-x} + x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xsol1</span><span class="p">,</span><span class="n">gg</span><span class="p">(</span><span class="n">xsol1</span><span class="p">),</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Root 1 of $x=-3\ln(x) + e^{-x} + x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iters = 0, x0 =  1.10000000, f(x0) =  1.14694054
iters = 1, x1 =  1.14694054, f(x1) =  1.05325353
iters = 2, x2 =  1.05325353, f(x2) =  1.24640268
iters = 3, x3 =  1.24640268, f(x3) =  0.87315535
iters = 4, x4 =  0.87315535, f(x4) =  1.69771241
iters = 5, x5 =  1.69771241, f(x5) =  0.29296921
iters = 6, x6 =  0.29296921, f(x6) =  4.72207762
iters = 7, x7 =  4.72207762, f(x7) =  0.07422767
iters = 8, x8 =  0.07422767, f(x8) =  8.80454297
iters = 9, x9 =  8.80454297, f(x9) =  2.27888952
iters = 10, x10 =  2.27888952, f(x10) = -0.08977744
iters = 11, x11 = -0.08977744, f(x11) =  nan
iters = 12, x12 =  nan, f(x12) =  nan
iters = 13, x13 =  nan, f(x13) =  nan
iters = 14, x14 =  nan, f(x14) =  nan
iters = 15, x15 =  nan, f(x15) =  nan
iters = 16, x16 =  nan, f(x16) =  nan
iters = 17, x17 =  nan, f(x17) =  nan
iters = 18, x18 =  nan, f(x18) =  nan
iters = 19, x19 =  nan, f(x19) =  nan
iters = 20, x20 =  nan, f(x20) =  nan
ROOT: nan obtained at ITERATION: 21
nan
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/vx/qqb0fxy10w7gw7s5kqcyx5cw0000gn/T/ipykernel_62730/862308035.py:4: RuntimeWarning: invalid value encountered in log
  gg = lambda x: -3*np.log(x) + np.exp(-x) + x
</pre></div>
</div>
<img alt="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_106_2.png" src="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_106_2.png" />
</div>
</div>
<p>例：
\begin{equation}
f(x) = e^{-x} - 3 \ln(x),\quad g(x) = e^{e^{-x}/3}
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">gg</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">xsol1</span> <span class="o">=</span> <span class="n">fixedPointIteration</span><span class="p">(</span><span class="n">gg</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xsol1</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$y=x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">gg</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$y=e^{e^{-x}/3}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xsol1</span><span class="p">,</span><span class="n">gg</span><span class="p">(</span><span class="n">xsol1</span><span class="p">),</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Root 1 of $x= e^{e^{-x}/3}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iters = 0, x0 =  1.50000000, f(x0) =  1.07721254
iters = 1, x1 =  1.07721254, f(x1) =  1.12020812
iters = 2, x2 =  1.12020812, f(x2) =  1.11486943
iters = 3, x3 =  1.11486943, f(x3) =  1.11551855
ROOT: 1.115518551413356 obtained at ITERATION: 4
1.115518551413356
</pre></div>
</div>
<img alt="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_108_1.png" src="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_108_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="newton-method-or-newton-raphson-method">
<h2>牛顿法（Newton Method or Newton-Raphson Method）<a class="headerlink" href="#newton-method-or-newton-raphson-method" title="Permalink to this headline">¶</a></h2>
<div class="section" id="newton">
<h3>Newton法的基本原理<a class="headerlink" href="#newton" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Newton\)</span>法的基本思想是将非线性方程线性化。</p></li>
</ul>
<p>设<span class="math notranslate nohighlight">\(x_k\)</span>是<span class="math notranslate nohighlight">\(f(x)=0\)</span>的近似根，将<span class="math notranslate nohighlight">\(f(x)\)</span>在<span class="math notranslate nohighlight">\(x_k\)</span>处<span class="math notranslate nohighlight">\(Taylor\)</span>展开
\begin{equation*}
\begin{aligned}
f(x) &amp;= f(x_k) + f^\prime(x_k)(x-x_k) + \frac{f^{\prime\prime}(\xi) }{2!}(x-x_k)^2 + h.o.t \
&amp;\approx f(x_k) + f^\prime(x_k)(x-x_k) \triangleq P(x).
\end{aligned}
\end{equation*}
令<span class="math notranslate nohighlight">\(P(x) = 0\)</span>，当<span class="math notranslate nohighlight">\(\boxed{f^\prime(x) \neq 0}\)</span>时，我们可以得到
\begin{equation*}
x_{k+1} = x_k - \frac{f(x_k)}{f^\prime(x_k)}
\end{equation*}</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Newton\)</span>法的几何意义如下：</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(x_{k+1}\)</span>为函数<span class="math notranslate nohighlight">\(f(x)\)</span>在点<span class="math notranslate nohighlight">\(x_k\)</span>处的切线与横坐标轴的交点。因此<span class="math notranslate nohighlight">\(Newton\)</span>迭代法也称为切线法。</p>
<p><img alt="newton_iteration_show.jpg" src="images/newton_iteration_show.jpg" /></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Newton\)</span>法的基本算法流程：</p></li>
</ul>
<ol class="simple">
<li><p>任取迭代初始值<span class="math notranslate nohighlight">\(x_0\)</span></p></li>
<li><p>计算<span class="math notranslate nohighlight">\(x_1 = x_0 - \frac{f(x_0)}{f^\prime(x_0)}\)</span></p></li>
<li><p>判断收敛性：如果<span class="math notranslate nohighlight">\(|x_1 - x_0| &lt; \epsilon\)</span>或者<span class="math notranslate nohighlight">\(|f(x_1)| &lt; \epsilon\)</span>，则算法收敛，停止计算，输出近似解<span class="math notranslate nohighlight">\(x_1\)</span></p></li>
<li><p>令<span class="math notranslate nohighlight">\(x_0 \leftarrow x_1\)</span>，返回第二步</p></li>
</ol>
</div>
<div class="section" id="id16">
<h3>Newton法的收敛性<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<p><strong>!定理</strong>： 设<span class="math notranslate nohighlight">\(f(x^*) = 0\)</span>，<span class="math notranslate nohighlight">\(f^\prime(x^*) \neq 0\)</span>，且<span class="math notranslate nohighlight">\(f(x)\)</span>在包含<span class="math notranslate nohighlight">\(x^*\)</span>的某个区间上二阶连续可微，则<span class="math notranslate nohighlight">\(Newton\)</span>迭代法至少二阶收敛，且
\begin{equation*}
\lim_{k \to \infty} \frac{x_{k+1} - x^<em>}{(x_k - x^</em>)^2} = \frac{f^{\prime\prime}(x^<em>)}{2 f^\prime(x^</em>)}
\end{equation*}</p>
<p><strong>证明</strong>
将<span class="math notranslate nohighlight">\(Newton\)</span>迭代法改写成一般的不动点迭代法格式，有
\begin{equation*}
\varphi(x) = x - \frac{f(x)}{f^\prime(x)},\quad \varphi^\prime(x) = \frac{f(x)f^{\prime\prime}(x)}{[f^\prime(x)]^2}
\end{equation*}
很明显，由于<span class="math notranslate nohighlight">\(\varphi(x^*) = 0\)</span>，<span class="math notranslate nohighlight">\(\varphi^\prime(x^*) = 0\)</span>，<span class="math notranslate nohighlight">\(Newton\)</span>迭代法至少二阶收敛。此外
\begin{equation*}
\lim_{k \to \infty} \frac{x_{k+1} - x^<em>}{(x_k - x^</em>)^2} = \lim_{k \to \infty} \frac{f^{\prime\prime}(\xi)}{2 f^\prime(\xi)} = \frac{f^{\prime\prime}(x^<em>)}{2 f^\prime(x^</em>)}
\end{equation*}</p>
<p><strong>!例</strong>： 用<span class="math notranslate nohighlight">\(Newton\)</span>法求<span class="math notranslate nohighlight">\(f(x) = x^2 - C = 0\)</span>的正根。</p>
<p><strong>!解</strong>：</p>
<p><span class="math notranslate nohighlight">\(f(x)\)</span>的<span class="math notranslate nohighlight">\(Newton\)</span>迭代格式为
\begin{equation*}
x_{k+1} = \frac{1}{2}\left( x_k + \frac{C}{x_k} \right)
\end{equation*}
从而有
\begin{equation*}
\frac{x_{k+1} - \sqrt{C}}{x_{k+1} + \sqrt{C}} = \left( \frac{x_{k} - \sqrt{C}}{x_{k} + \sqrt{C}} \right)^2 = \left( \frac{x_{0} - \sqrt{C}}{x_{0} + \sqrt{C}} \right)^{2^{k+1}} \triangleq q^{2^{k+1}}
\end{equation*}
\begin{equation*}
x_{k} - \sqrt{C} = 2 \sqrt{C} \frac{q^{2^k}}{1 - q^{2^k}}
\end{equation*}</p>
<p>从而，对任意<span class="math notranslate nohighlight">\(x_0&gt;0\)</span>，总有<span class="math notranslate nohighlight">\(|q|&lt;1\)</span>，即牛顿法收敛。</p>
<p><strong>!TIPS</strong>： 牛顿迭代法的优点：至少二阶局部收敛，收敛速度较快，特别是当迭代点充分靠近精确解时。</p>
<p><strong>!TIPS</strong>： <font color="magenta">牛顿法是目前求解非线性方程 (组) 的主要方法</font></p>
<p><strong>!TIPS</strong>： 牛顿迭代法的缺点：</p>
<ul class="simple">
<li><p>对重根收敛速度较慢（线性收敛）</p></li>
<li><p>对初值的选取很敏感，要求初值相当接近真解</p></li>
<li><p>每一次迭代都需要计算导数！</p></li>
</ul>
<p><strong>!TIPS</strong>： <font color="magenta">实际使用过程中，一般先用其它算法获取一个近似解，然后使用牛顿法</font></p>
</div>
<div class="section" id="id17">
<h3>Newton法的示例<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="id18">
<h3>Newton法的变种<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id19">
<h4>简化的Newton法<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h4>
<p>其基本思想是：用<span class="math notranslate nohighlight">\(f^\prime(x_0)\)</span>替代所有的<span class="math notranslate nohighlight">\(f^\prime(x_k)\)</span>
\begin{equation}
x_{k+1} = x_k - \frac{f(x_k)}{f^\prime(x_0)}
\end{equation}
该迭代格式是线性收敛的：</p>
<ul class="simple">
<li><p>好处：只需要计算一次导数，即<span class="math notranslate nohighlight">\(f^\prime(x_0)\)</span></p></li>
<li><p>缺点：只有线性收敛速度（假定方法是收敛的）</p></li>
</ul>
</div>
<div class="section" id="id20">
<h4>Newton下山法<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h4>
<p>其基本思想是：要求每一步迭代满足下降条件
\begin{equation*}
|f(x_{k+1})| &lt; |f(x_{k})|
\end{equation*}
从而保证全局收敛性。</p>
<p>具体的做法是：在迭代格式中增加下山因子<span class="math notranslate nohighlight">\(\lambda\)</span>
\begin{equation*}
x_{k+1} = x_k - \lambda \frac{f(x_k)}{f^\prime(x_k)}
\end{equation*}</p>
<p>其中下山因子的取法为</p>
<p>从<span class="math notranslate nohighlight">\(\lambda=1\)</span>开始，逐次减半，直到满足下降条件为止。</p>
</div>
</div>
<div class="section" id="newtonpython">
<h3>Newton法的Python实现<a class="headerlink" href="#newtonpython" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id21">
<h4>Python代码<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">newtonRaphson</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">Df</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">epsilon</span><span class="p">,</span><span class="n">max_iter</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Approximate solution of f(x)=0 by Newton&#39;s method.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    f : function</span>
<span class="sd">        Function for which we are searching for a solution f(x)=0.</span>
<span class="sd">    Df : function</span>
<span class="sd">        Derivative of f(x).</span>
<span class="sd">    x0 : number</span>
<span class="sd">        Initial guess for a solution f(x)=0.</span>
<span class="sd">    epsilon : number</span>
<span class="sd">        Stopping criteria is abs(f(x)) &lt; epsilon.</span>
<span class="sd">    max_iter : integer</span>
<span class="sd">        Maximum number of iterations of Newton&#39;s method.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    xn : number</span>
<span class="sd">        Implement Newton&#39;s method: compute the linear approximation</span>
<span class="sd">        of f(x) at xn and find x intercept by the formula</span>
<span class="sd">            x = xn - f(xn)/Df(xn)</span>
<span class="sd">        Continue until abs(f(xn)) &lt; epsilon and return xn.</span>
<span class="sd">        If Df(xn) == 0, return None. If the number of iterations</span>
<span class="sd">        exceeds max_iter, then return None.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; f = lambda x: x**2 - x - 1</span>
<span class="sd">    &gt;&gt;&gt; Df = lambda x: 2*x - 1</span>
<span class="sd">    &gt;&gt;&gt; newton(f,Df,1,1e-8,10)</span>
<span class="sd">    Found solution after 5 iterations.</span>
<span class="sd">    1.618033988749989</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">xn</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">max_iter</span><span class="p">):</span>
        <span class="n">fxn</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xn</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">fxn</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found solution after&#39;</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="s1">&#39;iterations.&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">xn</span>
        <span class="n">Dfxn</span> <span class="o">=</span> <span class="n">Df</span><span class="p">(</span><span class="n">xn</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Dfxn</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Zero derivative. No solution found.&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">xn</span> <span class="o">=</span> <span class="n">xn</span> <span class="o">-</span> <span class="n">fxn</span><span class="o">/</span><span class="n">Dfxn</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exceeded maximum iterations. No solution found.&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id22">
<h4>Python代码使用实例<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">Dp</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span>
<span class="n">approx</span> <span class="o">=</span> <span class="n">newtonRaphson</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">Dp</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">approx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found solution after 6 iterations.
1.4655712318767877
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">Df</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">approx</span> <span class="o">=</span> <span class="n">newtonRaphson</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">Df</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">1e-2</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exceeded maximum iterations. No solution found.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id23">
<h4>Python代码使用训练题<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h4>
<p>Let <span class="math notranslate nohighlight">\(p(x) = x^3 - x - 1\)</span>. The only real root of <span class="math notranslate nohighlight">\(p(x)\)</span> is called the <font color="magenta">plastic number</font> and is given by
\begin{equation}
\frac{\sqrt[3]{108+12\sqrt{69}} + \sqrt[3]{108-12\sqrt{69}}}{6}<br />
\end{equation}</p>
<ol class="simple">
<li><p>Choose <span class="math notranslate nohighlight">\(x_0 = 1\)</span> and implement <span class="math notranslate nohighlight">\(2\)</span> iterations of Newton’s method to approximate the plastic number.</p></li>
<li><p>Use the exact value above to compute the absolute error after <span class="math notranslate nohighlight">\(2\)</span> iterations of Newton’s method.</p></li>
<li><p>Starting with the subinterval <span class="math notranslate nohighlight">\([1,2]\)</span>, how many iterations of the bisection method is required to achieve the same accuracy?</p></li>
</ol>
</div>
</div>
</div>
<div class="section" id="convergence-and-acceleration">
<h2>迭代法的收敛速度及其加速 （Convergence and Acceleration)<a class="headerlink" href="#convergence-and-acceleration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id24">
<h3>迭代法的收敛加速<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h3>
<p>对于线性收敛的迭代法，常常收敛速度很慢，所以一般要在基本不动点迭代法的基础上考虑加速收敛的方法。</p>
<p>设<span class="math notranslate nohighlight">\(\{ x_k \}\)</span>线性收敛到<span class="math notranslate nohighlight">\(x^*\)</span>，则迭代误差<span class="math notranslate nohighlight">\(e_k = x_k - x^*\)</span>满足
\begin{equation*}
\lim_{k \to \infty} \frac{e_{k+1}}{e_k} = \lim_{k \to \infty} \frac{x_{k+1} - x^<em>}{x_k - x^</em>} = C \neq 0
\end{equation*}
因此，当<span class="math notranslate nohighlight">\(k\)</span>充分大的时候，有
\begin{equation*}
\frac{x_{k+1} - x^<em>}{x_k - x^</em>} \approx \frac{x_{k+2} - x^<em>}{x_{k+1} - x^</em>} \approx C,
\end{equation*}
从式中解出<span class="math notranslate nohighlight">\(x^*\)</span>可得
\begin{equation*}
x^* \approx x_{k} - \frac{(x_{k+1} - x_{k})^2}{x_{k+2} - 2 x_{k+1} + x_k}
\end{equation*}</p>
<p>由此，我们取新数列<span class="math notranslate nohighlight">\(\{ \hat{x}_k \}_{k=0}^\infty\)</span>定义如下：
\begin{equation*}
\hat{x}<em>k \equiv x</em>{k} - \frac{(x_{k+1} - x_{k})^2}{x_{k+2} - 2 x_{k+1} + x_k}.
\end{equation*}
可证明该数列<span class="math notranslate nohighlight">\(\{ \hat{x}_k \}_{k=0}^\infty\)</span>的收敛速度要比<span class="math notranslate nohighlight">\(\{ x_k \}_{k=0}^\infty\)</span>快，即
\begin{equation*}
\lim_{k \to \infty} \frac{\hat{x}_k - x^<em>}{x_k - x^</em>} = 0
\end{equation*}
这种通过改变数列的定义方式来提高收敛速度的方法称为<font color="magenta"><span class="math notranslate nohighlight">\(Aitken\)</span>加速法</font>，在改进线性收敛数列的收敛速度上经常采用。[Pomeranz, S. B. (2017). Aitken’s <span class="math notranslate nohighlight">\(\Delta^2\)</span> method extended. Cogent Mathematics, 4(1), 1308622.]</p>
<p>将<span class="math notranslate nohighlight">\(Aitken\)</span>加速法与不动点迭代法结合起来，我们就能够获得<font color="magenta"><span class="math notranslate nohighlight">\(Steffensen\)</span>迭代法</font>：
\begin{equation*}
\left{\begin{aligned}
y_k     &amp;= \varphi(x_k) \
z_k     &amp;= \varphi(y_k) \
x_{k+1} &amp;= x_k - \frac{(y_k - x_k)^2}{z_k - 2 y_k + x_k}
\end{aligned}\right.
\end{equation*}
其对应的迭代函数<span class="math notranslate nohighlight">\(\psi(x)\)</span>为
\begin{equation*}
\boxed{x_{k+1} = \psi(x_k),\quad \psi(x) = x - \frac{(\varphi(x) - x)^2}{\varphi(\varphi(x)) - 2 \varphi(x) + x}}
\end{equation*}</p>
<p><strong>!例</strong>： 求方程<span class="math notranslate nohighlight">\(f(x) = x e^x - 1 = 0\)</span>的根。</p>
<p><strong>解</strong>
若采用<span class="math notranslate nohighlight">\(Steffensen\)</span>迭代法，仍取初始值<span class="math notranslate nohighlight">\(x_0 = 0.5\)</span>，则
\begin{equation*}
\begin{aligned}
y_k &amp;= e^{-x_k},\ z_k = e^{-y_k},\
x_{k+1} &amp;= x_k - \frac{(y_k - x_k)^2}{z_k - 2 y_k + x_k}
\end{aligned}
\end{equation*}
计算结果列于下表</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(k\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(0\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(1\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(2\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(3\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(4\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(x_k\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0.5\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0.567623876\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0.567143314\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0.567143290\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0.567143290\)</span></p></td>
</tr>
</tbody>
</table>
<p>比较而言，可以发现，<span class="math notranslate nohighlight">\(Steffensen\)</span>迭代法比原不动点迭代法收敛得快得多，仅迭代<span class="math notranslate nohighlight">\(4\)</span>次就达到了原方法<span class="math notranslate nohighlight">\(29\)</span>次的结果。</p>
<p><strong>!定理</strong>： 设函数<span class="math notranslate nohighlight">\(\varphi(x)\)</span>和<span class="math notranslate nohighlight">\(\psi(x)\)</span>按之前的定义，即
\begin{equation*}
\psi(x) = x - \frac{(\varphi(x) - x)^2}{\varphi(\varphi(x)) - 2 \varphi(x) + x}
\end{equation*}
则我们可以对<span class="math notranslate nohighlight">\(Steffensen\)</span>迭代法获得如下结论：</p>
<ol class="simple">
<li><p>若<span class="math notranslate nohighlight">\(x^*\)</span>是<span class="math notranslate nohighlight">\(\varphi(x)\)</span>的不动点，<span class="math notranslate nohighlight">\(\varphi(x)\)</span>在<span class="math notranslate nohighlight">\(x^*\)</span>处连续，且<span class="math notranslate nohighlight">\(\varphi^\prime(x^*) \neq 1\)</span>，则<span class="math notranslate nohighlight">\(x^*\)</span>也是<span class="math notranslate nohighlight">\(\psi(x)\)</span>的不动点；反之，若<span class="math notranslate nohighlight">\(x^*\)</span>是<span class="math notranslate nohighlight">\(\psi(x)\)</span>的不动点，则<span class="math notranslate nohighlight">\(x^*\)</span>也是<span class="math notranslate nohighlight">\(\varphi(x)\)</span>的不动点。</p></li>
<li><p>若<span class="math notranslate nohighlight">\(x^*\)</span>是<span class="math notranslate nohighlight">\(\varphi(x)\)</span>的不动点，<span class="math notranslate nohighlight">\(\varphi^{\prime\prime}(x)\)</span>在<span class="math notranslate nohighlight">\(x^*\)</span>处连续，且<span class="math notranslate nohighlight">\(\varphi^\prime(x^*) \neq 1\)</span>，则<span class="math notranslate nohighlight">\(Steffensen\)</span>迭代法至少具有二阶局部收敛性。</p></li>
</ol>
<p><strong>证明</strong>
（1）若<span class="math notranslate nohighlight">\(x^* = \varphi(x^*)\)</span>，则当<span class="math notranslate nohighlight">\(x= x^*\)</span>时，<span class="math notranslate nohighlight">\(\psi\)</span>时没有定义的，其分子分母都为零。采用<span class="math notranslate nohighlight">\(L'Hospitale\)</span>法则，由于<span class="math notranslate nohighlight">\(\varphi^\prime(x^*) \neq 1\)</span>，可以得到</p>
<p>\begin{equation*}
\begin{aligned}
\lim_{x\to x^<em>}\psi(x) &amp;= \lim_{x\to x^</em>} \frac{\varphi(\varphi(x)) + x \varphi^\prime(\varphi(x)) \varphi^\prime(x) - 2 \varphi(x) \varphi^\prime(x)}{\varphi^\prime(\varphi(x))\varphi^\prime(x) - 2 \varphi^\prime(x) + 1} \
&amp;= \frac{x^* \left[ \varphi^\prime(x^<em>) - 1 \right]^2}{ \left[ \varphi^\prime(x^</em>) - 1 \right]^2 } = x^*
\end{aligned}
\end{equation*}</p>
<p>从而<span class="math notranslate nohighlight">\(x^* = \psi(x^*)\)</span>。反之，若<span class="math notranslate nohighlight">\(x^* = \psi(x^*)\)</span>，则根据<span class="math notranslate nohighlight">\(\psi(x)\)</span>的定义式得知<span class="math notranslate nohighlight">\(x^* = \varphi(x^*)\)</span>。</p>
<p>（2）由(1)可知，<span class="math notranslate nohighlight">\(x^*\)</span>是<span class="math notranslate nohighlight">\(\psi(x)\)</span>的不动点，因此，根据前述的局部收敛阶定理，只需要证明<span class="math notranslate nohighlight">\(\varphi^{\prime}(x) = 0\)</span>。为此，我们对<span class="math notranslate nohighlight">\(\psi(x)\)</span>的定义式进行求导，可得
\begin{equation*}
1 - \psi^\prime(x) = \frac{p(x)}{q(x)},
\end{equation*}
其中：
\begin{equation*}
\begin{aligned}
p(x) &amp;= 2 [\varphi(x) - x][\varphi^{\prime}(x) - 1][\varphi(\varphi(x)) - 2 \varphi(x) + x] \
&amp;- \left[ \varphi(x) - x \right]^2 \left[ \varphi^{\prime}(\varphi(x)) \varphi^{\prime}(x) - 2 \varphi^{\prime}(x) + 1 \right]\
q(x) &amp;= \left[ \varphi(\varphi(x)) - 2 \varphi(x) + x \right]^2
\end{aligned}
\end{equation*}</p>
<p>容易算出
\begin{equation*}
p^{\prime\prime}(x^<em>) = q^{\prime\prime}(x^</em>) = 2 \left[ \varphi^{\prime}(x^<em>) - 1 \right]^4
\end{equation</em>}
于是，由于<span class="math notranslate nohighlight">\(|\varphi^{\prime}(x^*)| \neq 1\)</span>，可知
$<span class="math notranslate nohighlight">\(p^{\prime\prime}(x^*) = q^{\prime\prime}(x^*) \neq 0\)</span><span class="math notranslate nohighlight">\(
从而再次使用\)</span>L’Hospitale<span class="math notranslate nohighlight">\(法则可知
\begin{equation*}
    1 - \psi^\prime(x^*) = \lim_{x \to x^*} [ 1 - \psi^\prime(x)] = \lim_{x \to x^*} \frac{p(x)}{q(x)} = \lim_{x \to x^*} \frac{p^{\prime\prime}(x)}{q^{\prime\prime}(x)} = 1
\end{equation*}
从而\)</span>\psi^\prime(x^*) = 0$。定理得证。</p>
<p><strong>！TIPS</strong>：若原迭代格式是<span class="math notranslate nohighlight">\(p\)</span>阶收敛的，则对应的<span class="math notranslate nohighlight">\(Steffensen\)</span>迭代是<span class="math notranslate nohighlight">\(p+1\)</span>阶收敛的。</p>
</div>
<div class="section" id="id25">
<h3>Python示例<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="other-complex-methods">
<h2>其他复杂方法 （Other Complex Methods）<a class="headerlink" href="#other-complex-methods" title="Permalink to this headline">¶</a></h2>
<div class="section" id="secant-method">
<h3>割线法（Secant Method）<a class="headerlink" href="#secant-method" title="Permalink to this headline">¶</a></h3>
<p>割线法与前述的迭代法（二分法，不动点迭代法，Newton迭代法）的主要不同是，每一步迭代的时候需要提供两个已知值。割线法的处理方式和理解方式主要有两种：</p>
<ul class="simple">
<li><p>作为二分法的变种</p></li>
<li><p>作为Newton法的变种</p></li>
</ul>
<div class="section" id="id26">
<h4>割线法作为二分法的变种<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://personal.math.ubc.ca/~pwalls/math-python/roots-optimization/secant/">作为二分法变种的割线法</a>与二分法的基本条件一致：对于在区间<span class="math notranslate nohighlight">\([a,b]\)</span>上的连续函数<span class="math notranslate nohighlight">\(f(x)\)</span>，要求<span class="math notranslate nohighlight">\(f(a)f(b)&lt;0\)</span>，则根据中值定理，在区间<span class="math notranslate nohighlight">\([a,b]\)</span>内某一点<span class="math notranslate nohighlight">\(x^*\)</span>处必然有<span class="math notranslate nohighlight">\(f(x^*)=0\)</span>。</p>
<p>所不同的是，二分法利用对区间的不断对分来更新有根子区间并逐步逼近<span class="math notranslate nohighlight">\(x^*\)</span>，而割线法则利用连接<span class="math notranslate nohighlight">\((a,f(a))\)</span>和<span class="math notranslate nohighlight">\((b,f(b))\)</span>两点的割线与<span class="math notranslate nohighlight">\(x\)</span>轴的交点来不断更新有根子区间并逼近<span class="math notranslate nohighlight">\(x^*\)</span>。</p>
<ul class="simple">
<li><p>首先，连接<span class="math notranslate nohighlight">\((a,f(a))\)</span>和<span class="math notranslate nohighlight">\((b,f(b))\)</span>两点的割线方程为
\begin{equation}
y = \frac{f(b) - f(a)}{b-a}(x-a) + f(a)
\end{equation}</p></li>
<li><p>其次，考虑该割线与<span class="math notranslate nohighlight">\(x\)</span>轴的交点，在上式中令<span class="math notranslate nohighlight">\(y=0\)</span>，即
\begin{equation}
0 = \frac{f(b) - f(a)}{b-a}(x-a) + f(a)
\end{equation}
可得交点的横坐标为
\begin{equation}
x = a - f(a)\frac{b-a}{f(b) - f(a)}
\end{equation}</p></li>
</ul>
<p>这种情况下，割线法的算法与二分法一致，唯一的区别在于确定有根子区间的方法。基本的<font color='red'>算法步骤</font>如下</p>
<ol class="simple">
<li><p>确定一个有根区间<span class="math notranslate nohighlight">\([a_0,b_0]\)</span>，使得它满足<span class="math notranslate nohighlight">\(f(a_0) f(b_0) &lt;0\)</span>;</p></li>
<li><p>计算<span class="math notranslate nohighlight">\(f(x_0)\)</span>，其中<span class="math notranslate nohighlight">\(x_0\)</span>是割线与<span class="math notranslate nohighlight">\(x\)</span>轴的交点：
\begin{equation}
x_0 = a_0 - f(a_0)\frac{b_0-a_0}{f(b_0) - f(a_0)}
\end{equation}</p></li>
<li><p>确定下一个有根区间<span class="math notranslate nohighlight">\([a_1,b_1]\)</span>：</p>
<ol class="simple">
<li><p>如果<span class="math notranslate nohighlight">\(f(a_0) f(x_0) &lt;0\)</span>，则取<span class="math notranslate nohighlight">\(a_1 = a_0\)</span>, <span class="math notranslate nohighlight">\(b_1 = x_0\)</span>，新的有根区间为<span class="math notranslate nohighlight">\([a_1,b_1]\)</span>.</p></li>
<li><p>如果<span class="math notranslate nohighlight">\(f(x_0) f(b_0) &lt;0\)</span>，则取<span class="math notranslate nohighlight">\(a_1 = x_0\)</span>, <span class="math notranslate nohighlight">\(b_1 = b_0\)</span>，新的有根区间为<span class="math notranslate nohighlight">\([a_1,b_1]\)</span>.</p></li>
</ol>
</li>
<li><p>重复第(2)和第(3)步直到获得最终的有根区间<span class="math notranslate nohighlight">\([a_N,b_N]\)</span>达到预设目标.</p></li>
<li><p>求得第<span class="math notranslate nohighlight">\(N\)</span>个有根区间中求得的割线与与<span class="math notranslate nohighlight">\(x\)</span>轴的交点<span class="math notranslate nohighlight">\(x_N\)</span>。</p></li>
</ol>
<p>在这种情况下，割线法的代码如下：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">secantIteration</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Approximate solution of f(x)=0 on interval [a,b] by the secant method.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    func : function</span>
<span class="sd">        The function for which we are trying to approximate a solution f(x)=0.</span>
<span class="sd">    a,b : numbers</span>
<span class="sd">        The interval in which to search for a solution. The function returns</span>
<span class="sd">        None if f(a)*f(b) &gt;= 0 since a solution is not guaranteed.</span>
<span class="sd">    tol : number</span>
<span class="sd">        The interval length or the absolute value of $f(x)$ which are thought </span>
<span class="sd">        to be zero. Sometimes it is represented by two numbers tolfunc</span>
<span class="sd">        and tolroot.</span>
<span class="sd">    maxiter: (positive) integer</span>
<span class="sd">        The number of iterations to implement.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    xN : number</span>
<span class="sd">        The x intercept of the secant line on the the Nth interval</span>
<span class="sd">            xn = an - f(an)*(bn - an)/(f(bn) - f(an))</span>
<span class="sd">        The initial interval [a0,b0] is given by [a,b]. If f(xn) == 0</span>
<span class="sd">        for some intercept xn then the function returns this solution.</span>
<span class="sd">        If all signs of values f(an), f(bn) and f(xn) are the same at any</span>
<span class="sd">        iterations, the secant method fails and return None.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; f = lambda x: x**2 - x - 1</span>
<span class="sd">    &gt;&gt;&gt; secantIteration(f,1,2,5)</span>
<span class="sd">    1.6180257510729614</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">func</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">func</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Secant method fails.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">an</span><span class="p">,</span> <span class="n">bn</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">xn</span> <span class="o">=</span> <span class="n">an</span> <span class="o">-</span> <span class="n">func</span><span class="p">(</span><span class="n">an</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">bn</span> <span class="o">-</span> <span class="n">an</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">bn</span><span class="p">)</span> <span class="o">-</span> <span class="n">func</span><span class="p">(</span><span class="n">an</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">func</span><span class="p">(</span><span class="n">an</span><span class="p">)</span><span class="o">*</span><span class="n">func</span><span class="p">(</span><span class="n">xn</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">an</span><span class="p">,</span> <span class="n">bn</span> <span class="o">=</span> <span class="n">an</span><span class="p">,</span> <span class="n">xn</span>
        <span class="k">elif</span> <span class="n">func</span><span class="p">(</span><span class="n">bn</span><span class="p">)</span><span class="o">*</span><span class="n">func</span><span class="p">(</span><span class="n">xn</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">an</span><span class="p">,</span> <span class="n">bn</span> <span class="o">=</span> <span class="n">xn</span><span class="p">,</span> <span class="n">bn</span>
        <span class="k">elif</span> <span class="n">func</span><span class="p">(</span><span class="n">xn</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Found exact solution.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">xn</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Secant method fails.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">an</span> <span class="o">-</span> <span class="n">func</span><span class="p">(</span><span class="n">an</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">bn</span> <span class="o">-</span> <span class="n">an</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">bn</span><span class="p">)</span> <span class="o">-</span> <span class="n">func</span><span class="p">(</span><span class="n">an</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">secantIteration</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found exact solution.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.618033988749895
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pp</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">supergolden</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">((</span><span class="mi">29</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">93</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> 
               <span class="p">((</span><span class="mi">29</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="mi">93</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mi">3</span>
<span class="n">approx</span> <span class="o">=</span> <span class="n">secantIteration</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">approx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">supergolden</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">supergolden</span> <span class="o">-</span> <span class="n">approx</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.4655712318767282
1.4655712318767682
3.9968028886505635e-14
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id27">
<h4>割线法作为Newton法的变种<a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://mmas.github.io/secant-julia">作为Newton法变种的割线法</a>，可以看作是将<span class="math notranslate nohighlight">\(Newton\)</span>法
\begin{equation}
x_{k+1} = x_k - \frac{f(x_k)}{f^\prime(x_k)}
\end{equation}
中的导数项<span class="math notranslate nohighlight">\(f^\prime(x_k)\)</span>用经过函数<span class="math notranslate nohighlight">\(f(x)\)</span>图像上的点<span class="math notranslate nohighlight">\((x_k,f(x_k))\)</span>和<span class="math notranslate nohighlight">\((x_{k-1},f(x_{k-1}))\)</span>的割线的斜率
\begin{equation}
\frac{f(x_{k-1}) - f(x_k)}{x_{k-1} - x_k}
\end{equation}
来代替。由此，我们获得了如下迭代公式
\begin{equation}
x_{k+1} = x_{k} - f(x_{k})\frac{x_{k} - x_{k-1}}{f(x_{k}) - f(x_{k-1})}
\end{equation}.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">def</span> <span class="nf">secant</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="n">maxiter</span> <span class="o">=</span> <span class="mi">30</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">):</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
        <span class="n">x</span>  <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">y1</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">atol</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="n">x1</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Max iteration exceeded&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ff</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span>
<span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span>
<span class="n">xsol1</span> <span class="o">=</span>  <span class="n">secant</span><span class="p">(</span><span class="n">ff</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
<span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.</span>
<span class="n">xsol2</span> <span class="o">=</span> <span class="n">secant</span><span class="p">(</span><span class="n">ff</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
<span class="n">xsol3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;xsol1 = </span><span class="si">{</span><span class="n">xsol1</span><span class="si">:</span><span class="s1">2.10f</span><span class="si">}</span><span class="s1">, with starting points x0 = 1.0, x1 = 2.0&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;xsol2 = </span><span class="si">{</span><span class="n">xsol2</span><span class="si">:</span><span class="s1">2.10f</span><span class="si">}</span><span class="s1">, with starting points x0 = 1.0, x1 = -2.0&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;xsol3 = </span><span class="si">{</span><span class="n">xsol3</span><span class="si">:</span><span class="s1">2.10f</span><span class="si">}</span><span class="s1">, accurate solution&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>xsol1 = 3.1622760801, with starting points x0 = 1.0, x1 = 2.0
xsol2 = -3.1622776610, with starting points x0 = 1.0, x1 = -2.0
xsol3 = 3.1622776602, accurate solution
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pp</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">supergolden</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">((</span><span class="mi">29</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">93</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> 
               <span class="p">((</span><span class="mi">29</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="mi">93</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mi">3</span>
<span class="n">approx</span> <span class="o">=</span> <span class="n">secant</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">approx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">supergolden</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">supergolden</span> <span class="o">-</span> <span class="n">approx</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.465571325486704
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.4655712318767682
9.360993580287413e-08
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id28">
<h4>其他实现<a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">secant_method</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">iterations</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the root calculated using the secant method.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span>
    <span class="k">return</span> <span class="n">x2</span>

<span class="k">def</span> <span class="nf">f_example</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">612</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">secant_method</span><span class="p">(</span><span class="n">f_example</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Root: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">root</span><span class="p">))</span>  <span class="c1"># Root: 24.738633748750722</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Root: 24.738633748750722
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="inverse-quadratic-interpolation-method">
<h3>反向二次插值法(Inverse Quadratic Interpolation Method)<a class="headerlink" href="#inverse-quadratic-interpolation-method" title="Permalink to this headline">¶</a></h3>
<p>反向二次插值法很少直接用来对非线性方程进行求根，一般作为Brent法的一部分。</p>
<p>反向二次插值法中，函数<span class="math notranslate nohighlight">\(f(x)\)</span>在三个点<span class="math notranslate nohighlight">\(x_0\)</span>，<span class="math notranslate nohighlight">\(x_1\)</span>和<span class="math notranslate nohighlight">\(x_2\)</span>处进行求值，其中<span class="math notranslate nohighlight">\(x_0\)</span>，<span class="math notranslate nohighlight">\(x_1\)</span>和<span class="math notranslate nohighlight">\(x_2\)</span>属于某个有根区间。对函数<span class="math notranslate nohighlight">\(f(x)\)</span>和<span class="math notranslate nohighlight">\(x\)</span>进行反向二次插值有
\begin{equation}
g(y) = \frac{(y - f(x_1))(y - f(x_2))}{(f(x_0) - f(x_1))(f(x_0) - f(x_2))} x_0 + \frac{(y - f(x_0))(y - f(x_2))}{(f(x_1) - f(x_0))(f(x_1) - f(x_2))} x_1 + \frac{(y - f(x_0))(y - f(x_1))}{(f(x_2) - f(x_0))(f(x_2) - f(x_1))} x_2
\end{equation}
此时，令<span class="math notranslate nohighlight">\(y=0\)</span>，我们可以得到
\begin{equation}
g(y) = x = \frac{f(x_1) f(x_2)}{(f(x_0) - f(x_1))(f(x_0) - f(x_2))} x_0 + \frac{ f(x_0) f(x_2)}{(f(x_1) - f(x_0))(f(x_1) - f(x_2))} x_1 + \frac{f(x_0) f(x_1)}{(f(x_2) - f(x_0))(f(x_2) - f(x_1))} x_2
\end{equation}
在每次迭代计算之后，<span class="math notranslate nohighlight">\(x_0\)</span>，<span class="math notranslate nohighlight">\(x_1\)</span>和<span class="math notranslate nohighlight">\(x_2\)</span>的更新规则如下：</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x_0\)</span>  <span class="math notranslate nohighlight">\(\Leftarrow\)</span> <span class="math notranslate nohighlight">\(x_1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x_1\)</span>  <span class="math notranslate nohighlight">\(\Leftarrow\)</span> <span class="math notranslate nohighlight">\(x_2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x_2\)</span>  <span class="math notranslate nohighlight">\(\Leftarrow\)</span> <span class="math notranslate nohighlight">\(x\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">def</span> <span class="nf">invquadinterp</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">xtol</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="n">ytol</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="n">maxiter</span> <span class="o">=</span> <span class="mi">50</span><span class="p">):</span>
    <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span><span class="o">*</span><span class="n">y1</span><span class="o">*</span><span class="n">y2</span><span class="o">/</span><span class="p">((</span><span class="n">y0</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y0</span><span class="o">-</span><span class="n">y2</span><span class="p">))</span> <span class="o">+</span> \
            <span class="n">x1</span><span class="o">*</span><span class="n">y0</span><span class="o">*</span><span class="n">y2</span><span class="o">/</span><span class="p">((</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y2</span><span class="p">))</span> <span class="o">+</span> \
            <span class="n">x2</span><span class="o">*</span><span class="n">y0</span><span class="o">*</span><span class="n">y1</span><span class="o">/</span><span class="p">((</span><span class="n">y2</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">))</span>
        <span class="c1"># x-tolerance.</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">xtol</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">xtol</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">xtol</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="c1"># y-tolerance.</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">ytol</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y</span>
    <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Max iteration exceeded&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mf">4.</span><span class="p">;</span> 
<span class="n">xapp</span> <span class="o">=</span> <span class="n">invquadinterp</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">xsol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;xapp=</span><span class="si">{</span><span class="n">xapp</span><span class="si">:</span><span class="s1">2.10f</span><span class="si">}</span><span class="se">\n</span><span class="s1">xsol=</span><span class="si">{</span><span class="n">xsol</span><span class="si">:</span><span class="s1">2.10f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>xapp=0.3660254037
xsol=0.3660254038
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="brent-brent-s-method">
<h3>Brent法（Brent’s Method）<a class="headerlink" href="#brent-brent-s-method" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://mmas.github.io/brent-julia">Brent法</a>或者Wijngaarden-Brent-Dekker法是一种综合使用二分法，割线法和反向二次插值法的非线性方程求根方法。只要求解区间上存在根，该方法总是能够获得最终的精确根的。</p>
<p>给定函数<span class="math notranslate nohighlight">\(f(x)\)</span>和有根区间<span class="math notranslate nohighlight">\([x_0,x_1]\)</span>，可以获得两个新的点<span class="math notranslate nohighlight">\(x_2\)</span>和<span class="math notranslate nohighlight">\(x_3\)</span>。这一过程中如果<span class="math notranslate nohighlight">\(|f(x_0)|&lt; |f(x_1)|\)</span>，则需要将<span class="math notranslate nohighlight">\(x_0\)</span>和<span class="math notranslate nohighlight">\(x_1\)</span>的值调换。</p>
<p>然后在每次迭代中，如果函数<span class="math notranslate nohighlight">\(f(x)\)</span>在<span class="math notranslate nohighlight">\(x_0\)</span>，<span class="math notranslate nohighlight">\(x_1\)</span>和<span class="math notranslate nohighlight">\(x_2\)</span>处的函数值是不同（在指定的误差范围内），则使用反向二次插值法获得新的<span class="math notranslate nohighlight">\(x\)</span>值。反之，则使用割线法获得新的<span class="math notranslate nohighlight">\(x\)</span>。此后，如果下列条件中的某一个满足，我们重新利用二分法来求<span class="math notranslate nohighlight">\(x\)</span>的值：</p>
<ul class="simple">
<li><p>如果<span class="math notranslate nohighlight">\(x\)</span>不是介于<span class="math notranslate nohighlight">\((3x_0+x_1)/4\)</span>和<span class="math notranslate nohighlight">\(x_1\)</span>之间；</p></li>
<li><p>如果前一步迭代中使用了二分法，或本次迭代为首次迭代且<span class="math notranslate nohighlight">\(|x-x_1|\geq \frac{1}{2}|x_1 - x_2|\)</span>；</p></li>
<li><p>如果前一步迭代中使用了二分法，或本次迭代为首次迭代且<span class="math notranslate nohighlight">\(|x_1-x_2|&lt; |\delta|\)</span>，其中<span class="math notranslate nohighlight">\(\delta\)</span>为设定的误差因数；</p></li>
<li><p>如果前一步迭代中未使用二分法，且<span class="math notranslate nohighlight">\(|x-x_1|\geq \frac{1}{2}|x_2 - x_3|\)</span>；</p></li>
<li><p>如果前一步迭代中未使用二分法，且<span class="math notranslate nohighlight">\(|x_2 - x_3| &lt; |\delta|\)</span>，其中<span class="math notranslate nohighlight">\(\delta\)</span>为设定的误差因数。</p></li>
</ul>
<p>上述过程中我们定义<span class="math notranslate nohighlight">\(\delta = 2 \epsilon x_1\)</span>，其中<span class="math notranslate nohighlight">\(\epsilon\)</span>是机械精度。</p>
<p>最后，新的<span class="math notranslate nohighlight">\(x_3\)</span>等于现在的<span class="math notranslate nohighlight">\(x_2\)</span>，新的<span class="math notranslate nohighlight">\(x_2\)</span>等于现在的<span class="math notranslate nohighlight">\(x_1\)</span>。如果<span class="math notranslate nohighlight">\(f(x)f(x_0) &lt;0\)</span>，则新的<span class="math notranslate nohighlight">\(x_1\)</span>取现在的<span class="math notranslate nohighlight">\(x\)</span>，否则新的<span class="math notranslate nohighlight">\(x_2\)</span>取现在的<span class="math notranslate nohighlight">\(x\)</span>。此时，如果对新的<span class="math notranslate nohighlight">\(x_0\)</span>和<span class="math notranslate nohighlight">\(x_1\)</span>而言，<span class="math notranslate nohighlight">\(|f(x_0)|&lt; |f(x_1)|\)</span>，则二者的值交换。该算法一直执行到<span class="math notranslate nohighlight">\(f(x)\)</span>或者<span class="math notranslate nohighlight">\(|x_1 - x_0|\)</span>小于给定的误差因数 。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">def</span> <span class="nf">brent</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">,</span> <span class="n">ytol</span><span class="o">=</span><span class="mf">2e-10</span><span class="p">,</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">EPS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>
    <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y1</span><span class="p">):</span>
        <span class="c1"># Swap lower and upper bounds.</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x0</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y0</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="n">y0</span>
    <span class="n">x3</span> <span class="o">=</span> <span class="n">x2</span>
    <span class="n">bisection</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># x-tolerance.</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">xtol</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x1</span>
        <span class="c1"># Use inverse quadratic interpolation if f(x0)!=f(x1)!=f(x2)</span>
        <span class="c1"># and linear interpolation (secant method) otherwise.</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y0</span><span class="o">-</span><span class="n">y2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ytol</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ytol</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span><span class="o">*</span><span class="n">y1</span><span class="o">*</span><span class="n">y2</span><span class="o">/</span><span class="p">((</span><span class="n">y0</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y0</span><span class="o">-</span><span class="n">y2</span><span class="p">))</span> <span class="o">+</span> \
                <span class="n">x1</span><span class="o">*</span><span class="n">y0</span><span class="o">*</span><span class="n">y2</span><span class="o">/</span><span class="p">((</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y2</span><span class="p">))</span> <span class="o">+</span> \
                <span class="n">x2</span><span class="o">*</span><span class="n">y0</span><span class="o">*</span><span class="n">y1</span><span class="o">/</span><span class="p">((</span><span class="n">y2</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">y1</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span>

        <span class="c1"># Use bisection method if satisfies the conditions.</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">EPS</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
        <span class="n">min1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span>
        <span class="n">min2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span>
        <span class="n">min3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x3</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x0</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">x1</span><span class="p">)</span> <span class="ow">or</span> \
           <span class="p">(</span><span class="n">bisection</span> <span class="ow">and</span> <span class="n">min1</span> <span class="o">&gt;=</span> <span class="n">min2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="ow">or</span> \
           <span class="p">(</span><span class="ow">not</span> <span class="n">bisection</span> <span class="ow">and</span> <span class="n">min1</span> <span class="o">&gt;=</span> <span class="n">min3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="ow">or</span> \
           <span class="p">(</span><span class="n">bisection</span> <span class="ow">and</span> <span class="n">min2</span> <span class="o">&lt;</span> <span class="n">delta</span><span class="p">)</span> <span class="ow">or</span> \
           <span class="p">(</span><span class="ow">not</span> <span class="n">bisection</span> <span class="ow">and</span> <span class="n">min3</span> <span class="o">&lt;</span> <span class="n">delta</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">bisection</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bisection</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="c1"># y-tolerance.</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">ytol</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>
        <span class="n">x3</span> <span class="o">=</span> <span class="n">x2</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">y0</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y1</span><span class="p">):</span>
            <span class="c1"># Swap lower and upper bounds.</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x0</span>
            <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y0</span>

    <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Max iteration exceeded&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mf">4.</span><span class="p">;</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">x1</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">brent</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">x1</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3660254037862235
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3660254037844387
</pre></div>
</div>
</div>
</div>
<div class="section" id="preparing-initial-values-and-conditions">
<h4>Preparing initial values and conditions<a class="headerlink" href="#preparing-initial-values-and-conditions" title="Permalink to this headline">¶</a></h4>
<p>We need an initial bracket to use Brent’s method. There are also multiple conditions that we must actively maintain. A summary of relevant variables will precede discussion of conditions.</p>
<p>k = the iteration number.</p>
<p>a_k = an endpoint of the bracket.</p>
<p>b_k = an endpoint of the bracket, and also the current iterate.</p>
<p>b_{k-1} = previous iterate, initially set to a_{0}.</p>
<p>\delta = a tolerance value that is relatively small</p>
<p>One condition is that the roots must be bracketed between a and b:</p>
<p>f(a_{k})*f(b_{k})&lt;0</p>
<p>The intermediate value theorem guarantees that the root will be bracketed if f(x) is continuous within this interval.</p>
<p>We also want |f(b)|&lt;|f(a)| to be true such that b is a better guess for the root than a. If necessary, switch values a and b. Then initialize a third point c such that b_{k-1} = a.</p>
</div>
<div class="section" id="the-iterative-process">
<h4>The iterative process<a class="headerlink" href="#the-iterative-process" title="Permalink to this headline">¶</a></h4>
<p>Now we have a, b, and b_{k-1} such that b_{k}\neq b_{k-1}. The following conditions need to be maintained and updated to prepare for subsequent iterations.</p>
<p>f(b_{k})*f(b_{k-1}) &lt; 0 to reduce size of our bracket.
|f(b_{k})| \leq |f(b_{k-1})| to make b our best approximate solution.
a_k is either distinct from b_k and c_k, or a_k = b_{k-1} and is the immediate past value of b_k.
At the end of each iteration, we have another condition that checks to see if we have an acceptable solution.</p>
<p>If |b_k-b_{k-1}| &lt; \delta, return b_k.
Else, find b_{k+1}.</p>
</div>
<div class="section" id="finding-b-k-1">
<h4>Finding b_{k+1}<a class="headerlink" href="#finding-b-k-1" title="Permalink to this headline">¶</a></h4>
<p>We have two different cases if we’re trying to find b_{k+1}. Steps 3 and 4 are rather complicated, and I won’t be covering the intermediate steps as I’m still trying to understand what happens there.</p>
<p>If a_k=b_{k-1}, then use secant interpolation to find b_{k+1}=\frac{a_k f(b_k) - b_k f(a_k)}{f(b_k)-f(a_k)}.
Else use inverse quadratic interpolation to find b_{k+1}.
Adjust or replace b_{k+1} with bisection method if necessary.
Adjust a_k, b_{k-1}, b_k, and b_{k+1} for next iteration if needed.</p>
</div>
<div class="section" id="rate-of-convergence">
<h4>Rate of convergence<a class="headerlink" href="#rate-of-convergence" title="Permalink to this headline">¶</a></h4>
<p>In the worst case, Brent’s method will use no more than N^{2} iterations where N is the number of iterations had this method been purely bisection. Otherwise, this algorithm can converge superlinearly such that:</p>
<p>\lim_{k\rightarrow \infty} \frac{\left |x_{k+1}-L \right |}{\left |x_k - L\right |} = \mu</p>
<p>and</p>
<p>\mu_{k}\rightarrow 0 as k\rightarrow \infty</p>
<p>where</p>
<p>\mu is the rate of convergence, and</p>
<p>L is the number that we’re converging to.</p>
</div>
</div>
</div>
<div class="section" id="id29">
<h2>利用Python对函数进行求根<a class="headerlink" href="#id29" title="Permalink to this headline">¶</a></h2>
<p>TRY IT! Using fsolve function from scipy to compute the root of <span class="math notranslate nohighlight">\(𝑓(𝑥)=cos(𝑥)−𝑥\)</span> near <span class="math notranslate nohighlight">\(−2\)</span>. Verify that the solution is a root (or close enough).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>

<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;r =&quot;</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

<span class="c1"># Verify the solution is a root</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;result=&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r = [0.73908513]
result= [0.]
</pre></div>
</div>
</div>
</div>
<p>TRY IT! The function <span class="math notranslate nohighlight">\(𝑓(𝑥)=\frac{1}{x}\)</span> has no root. Use the fsolve function to try to compute the root of <span class="math notranslate nohighlight">\(𝑓(𝑥)=\frac{1}{x}\)</span>. Turn on the “full_output” option to see what’s going on. Remember to check the documentation for details.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span>

<span class="n">r</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;r =&quot;</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;result=&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">mesg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r = [-3.52047359e+83]
result= [-2.84052692e-84]
The number of calls to function has reached maxfev = 400.
</pre></div>
</div>
</div>
</div>
<p>We can see that, the value <span class="math notranslate nohighlight">\(r\)</span> we got is not a root, even though the <span class="math notranslate nohighlight">\(f(r)\)</span> is a very small number. Since we turned on the full_output, which have more information. A message will be returned if no solution is found, and we can see mesg details for the cause of failure:</p>
<p>“The number of calls to function has reached maxfev = 400.”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Brent&#39;s method</span>
<span class="sd">================</span>

<span class="sd">Illustration of 1D optimization: Brent&#39;s method</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">x_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">epsilon</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">.5</span> <span class="o">-</span> <span class="n">x_0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">epsilon</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

    <span class="c1"># A convex function</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Apply brent method. To have access to the iteration, do this in an</span>
    <span class="c1"># artificial way: allow the algorithm to iter only once</span>
    <span class="n">all_x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">all_y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize_scalar</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">bracket</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Brent&quot;</span><span class="p">,</span>
                    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;maxiter&quot;</span><span class="p">:</span> <span class="nb">iter</span><span class="p">},</span> <span class="n">tol</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Converged at &#39;</span><span class="p">,</span> <span class="nb">iter</span><span class="p">)</span>
            <span class="k">break</span>

        <span class="n">this_x</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span>
        <span class="n">all_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_x</span><span class="p">)</span>
        <span class="n">all_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">this_x</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">iter</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">this_x</span> <span class="o">-</span> <span class="mf">.05</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">this_x</span><span class="p">)</span> <span class="o">-</span> <span class="mf">.05</span><span class="p">,</span>
                    <span class="n">f</span><span class="p">(</span><span class="n">this_x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.2</span><span class="o">*</span><span class="p">(</span><span class="mf">.3</span> <span class="o">-</span> <span class="nb">iter</span> <span class="o">%</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">iter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">all_x</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="n">all_y</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;k+&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">all_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">all_y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">all_y</span> <span class="o">-</span> <span class="n">all_y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Error on f(x)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Iteration&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Converged at  6
Converged at  23
</pre></div>
</div>
<img alt="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_182_1.png" src="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_182_1.png" />
<img alt="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_182_2.png" src="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_182_2.png" />
<img alt="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_182_3.png" src="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_182_3.png" />
<img alt="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_182_4.png" src="_images/mc_numerics_ch19-Roots-of-Nonlinear-Equations_182_4.png" />
</div>
</div>
</div>
<div class="section" id="id30">
<h2>小结<a class="headerlink" href="#id30" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="id31">
<h2>习题和讨论<a class="headerlink" href="#id31" title="Permalink to this headline">¶</a></h2>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="mc_numerics_ch14-Linear-System-of-Equations.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><center> 第14章: 线性方程组求解</center></p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="markdown.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Markdown Files</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By The Jupyter Book Community<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>